
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Boas Práticas e Design Patterns Clássicos &#8212; Programação Orientada a Objetos II (Avançado)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/aulas/aula-01-02-boas-praticas-design-patters/README';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Ambiente Profissional de Projetos Python" href="../aula-03-04-ambiente-profissional-python/README.html" />
    <link rel="prev" title="Programação Orientada a Objetos II (POOII) - Python" href="../../../README.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../README.html">
  
  
  
  
  
  
    <p class="title logo__title">Programação Orientada a Objetos II (Avançado)</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../README.html">
                    Programação Orientada a Objetos II (POOII) - Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Aulas da Disciplina</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Boas Práticas e Design Patterns Clássicos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aula-03-04-ambiente-profissional-python/README.html">Ambiente Profissional de Projetos Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aula-05-06-git-ci-cd-github-actions/README.html">Aula 3: Git e CI/CD com GitHub Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aula-07-08-refatoracao-code-smells-sonarcloud/README.html">Refatoração de Códigos, Code Smells e Integração com SonarCloud</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/docs/aulas/aula-01-02-boas-praticas-design-patters/README.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Boas Práticas e Design Patterns Clássicos</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sumario">Sumário</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#abertura-e-engajamento">1. Abertura e Engajamento</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problema-motivador">1.1. Problema Motivador</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#contexto-historico-e-relevancia-atual">1.2. Contexto Histórico e Relevância Atual</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fundamentos-teoricos">2. Fundamentos Teóricos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#terminologia-essencial-e-definicoes-formais"><strong>2.1. Terminologia Essencial e Definições Formais</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-limpo"><strong>Código Limpo</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#coesao"><strong>Coesão</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#acoplamento"><strong>Acoplamento</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estrutura-conceitual"><strong>2.2. Estrutura Conceitual</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#principios-de-boas-praticas-base-cientifica-do-design"><strong>2.2.1. Princípios de Boas Práticas - Base Científica do Design</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#single-responsibility-principle-srp"><strong>Single Responsibility Principle (SRP)</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#open-closed-principle-ocp"><strong>Open/Closed Principle (OCP)</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#liskov-substitution-principle-lsp"><strong>Liskov Substitution Principle (LSP)</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#interface-segregation-principle-isp"><strong>Interface Segregation Principle (ISP)</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dependency-inversion-principle-dip"><strong>Dependency Inversion Principle (DIP)</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dry-don-t-repeat-yourself"><strong>DRY (Don’t Repeat Yourself)</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#yagni-you-aren-t-gonna-need-it"><strong>YAGNI (You Aren’t Gonna Need It)</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#kiss-keep-it-simple-stupid"><strong>KISS (Keep It Simple, Stupid)</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#padroes-de-design-solucoes-catalogadas-para-problemas-recorrentes"><strong>2.2.2. Padrões de Design - Soluções Catalogadas para Problemas Recorrentes</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#strategy-pattern"><strong>Strategy Pattern</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#observer-pattern"><strong>Observer Pattern</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#command-pattern"><strong>Command Pattern</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-method-pattern"><strong>Factory Method Pattern</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#singleton-pattern"><strong>Singleton Pattern</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#adapter-pattern"><strong>Adapter Pattern</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analise-quantitativa-metricas-de-qualidade-de-software"><strong>2.3. Análise Quantitativa - Métricas de Qualidade de Software</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#metrica-de-coesao-lcom-lack-of-cohesion-of-methods"><strong>Métrica de Coesão LCOM (Lack of Cohesion of Methods)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#metrica-de-instabilidade-acoplamento-eferente-vs-aferente"><strong>Métrica de Instabilidade (Acoplamento Eferente vs. Aferente)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#complexidade-ciclomatica-de-mccabe"><strong>Complexidade Ciclomática de McCabe</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analise-critica"><strong>2.4. Análise Crítica</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#limitacoes-e-trade-offs-dos-principios"><strong>Limitações e Trade-offs dos Princípios</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#faq-perguntas-frequentes-e-armadilhas-comuns"><strong>FAQ - Perguntas Frequentes e Armadilhas Comuns</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tabela-comparativa-paradigmas-e-suas-implicacoes"><strong>Tabela Comparativa: Paradigmas e Suas Implicações</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacao-pratica-e-implementacao">3. Aplicação Prática e Implementação</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estudo-de-caso-guiado">3.1. Estudo de Caso Guiado</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#passo-1-analise-do-problema"><strong>Passo 1: Análise do Problema</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#passo-2-implementacao-inicial-problematica"><strong>Passo 2: Implementação Inicial Problemática</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#passo-3-refatoracao-aplicando-srp"><strong>Passo 3: Refatoração Aplicando SRP</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#passo-4-aplicando-open-closed-principle"><strong>Passo 4: Aplicando Open/Closed Principle</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exemplos-de-codigo-comentado">3.2. Exemplos de Código Comentado</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacao-do-padrao-strategy"><strong>Implementação do Padrão Strategy</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacao-do-padrao-factory-method"><strong>Implementação do Padrão Factory Method</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacao-do-padrao-observer"><strong>Implementação do Padrão Observer</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ferramentas-bibliotecas-e-ecossistema-contextual"><strong>3.3. Ferramentas, Bibliotecas e Ecossistema (Contextual)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recursos-nativos-utilizados"><strong>Recursos Nativos Utilizados</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#por-que-apenas-python-nativo"><strong>Por Que Apenas Python Nativo?</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ambiente-de-desenvolvimento-recomendado"><strong>Ambiente de Desenvolvimento Recomendado</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topicos-avancados-e-nuances">4. Tópicos Avançados e Nuances</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#desafios-comuns-e-anti-padroes">4.1. Desafios Comuns e “Anti-Padrões”</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#god-object-objeto-deus"><strong>God Object (Objeto Deus)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spaghetti-code-codigo-espaguete"><strong>Spaghetti Code (Código Espaguete)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shotgun-surgery-cirurgia-com-espingarda"><strong>Shotgun Surgery (Cirurgia com Espingarda)</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variacoes-e-arquiteturas-especializadas">4.2. Variações e Arquiteturas Especializadas</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arquitetura-hexagonal-ports-and-adapters"><strong>Arquitetura Hexagonal (Ports and Adapters)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#domain-driven-design-ddd-com-poo"><strong>Domain-Driven Design (DDD) com POO</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analise-de-performance-e-otimizacao">4.3. Análise de Performance e Otimização</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-performance-em-poo"><strong>Métricas de Performance em POO</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#profiling-e-identificacao-de-gargalos"><strong>Profiling e Identificação de Gargalos</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#event-sourcing-com-poo"><strong>Event Sourcing com POO</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">4.3. Análise de Performance e Otimização</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-qualidade-de-codigo"><strong>Métricas de Qualidade de Código</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sintese-e-perspectivas-futuras">5. Síntese e Perspectivas Futuras</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conexoes-com-outras-areas-da-computacao">5.1. Conexões com Outras Áreas da Computação</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#engenharia-de-software"><strong>Engenharia de Software</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ciencia-de-dados-e-ia"><strong>Ciência de Dados e IA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sistemas-distribuidos"><strong>Sistemas Distribuídos</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#seguranca-da-informacao"><strong>Segurança da Informação</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-fronteira-da-pesquisa-e-o-futuro">5.2. A Fronteira da Pesquisa e o Futuro</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tendencias-atuais-2025"><strong>Tendências Atuais (2025)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pesquisas-emergentes"><strong>Pesquisas Emergentes</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resumo-do-capitulo-e-mapa-mental">5.3. Resumo do Capítulo e Mapa Mental</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pontos-chave-do-capitulo"><strong>Pontos-Chave do Capítulo:</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mapa-mental-dos-conceitos"><strong>Mapa Mental dos Conceitos:</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#referencias-e-leituras-adicionais">5.4. Referências e Leituras Adicionais</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#livros-fundamentais"><strong>Livros Fundamentais:</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recursos-online"><strong>Recursos Online:</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#artigos-e-papers-relevantes"><strong>Artigos e Papers Relevantes:</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ferramentas-e-ecossistema"><strong>Ferramentas e Ecossistema:</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comunidades-e-recursos-continuos"><strong>Comunidades e Recursos Contínuos:</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="boas-praticas-e-design-patterns-classicos">
<h1>Boas Práticas e Design Patterns Clássicos<a class="headerlink" href="#boas-praticas-e-design-patterns-classicos" title="Link to this heading">#</a></h1>
<section id="sumario">
<h2>Sumário<a class="headerlink" href="#sumario" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#1-abertura-e-engajamento"><span class="xref myst">Abertura e Engajamento</span></a></p>
<ul class="simple">
<li><p>1.1. <a class="reference internal" href="#11-problema-motivador"><span class="xref myst">Problema Motivador</span></a></p></li>
<li><p>1.2. <a class="reference internal" href="#12-contexto-hist%C3%B3rico-e-relev%C3%A2ncia-atual"><span class="xref myst">Contexto Histórico e Relevância Atual</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#2-fundamentos-te%C3%B3ricos"><span class="xref myst">Fundamentos Teóricos</span></a></p>
<ul class="simple">
<li><p>2.1. <a class="reference internal" href="#21-terminologia-essencial-e-defini%C3%A7%C3%B5es-formais"><span class="xref myst">Terminologia Essencial e Definições Formais</span></a></p></li>
<li><p>2.2. <a class="reference internal" href="#22-os-pilares-das-boas-pr%C3%A1ticas-em-poo"><span class="xref myst">Os Pilares das Boas Práticas em POO</span></a></p></li>
<li><p>2.3. <a class="reference internal" href="#23-modelagem-matem%C3%A1tica-da-qualidade-de-software"><span class="xref myst">Modelagem Matemática da Qualidade de Software</span></a></p></li>
<li><p>2.4. <a class="reference internal" href="#24-an%C3%A1lise-cr%C3%ADtica"><span class="xref myst">Análise Crítica</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#3-aplica%C3%A7%C3%A3o-pr%C3%A1tica-e-implementa%C3%A7%C3%A3o"><span class="xref myst">Aplicação Prática e Implementação</span></a></p>
<ul class="simple">
<li><p>3.1. <a class="reference internal" href="#31-estudo-de-caso-guiado"><span class="xref myst">Estudo de Caso Guiado</span></a></p></li>
<li><p>3.2. <a class="reference internal" href="#32-exemplos-de-c%C3%B3digo-comentado"><span class="xref myst">Exemplos de Código Comentado</span></a></p></li>
<li><p>3.3. <a class="reference internal" href="#33-ferramentas-bibliotecas-e-ecossistema"><span class="xref myst">Ferramentas, Bibliotecas e Ecossistema</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#4-t%C3%B3picos-avan%C3%A7ados-e-nuances"><span class="xref myst">Tópicos Avançados e Nuances</span></a></p>
<ul class="simple">
<li><p>4.1. <a class="reference internal" href="#41-desafios-comuns-e-anti-padr%C3%B5es"><span class="xref myst">Desafios Comuns e Anti-Padrões</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#5-s%C3%ADntese-e-perspectivas-futuras"><span class="xref myst">Síntese e Perspectivas Futuras</span></a></p>
<ul class="simple">
<li><p>5.1. <a class="reference internal" href="#51-conex%C3%B5es-com-outras-%C3%A1reas-da-computa%C3%A7%C3%A3o"><span class="xref myst">Conexões com Outras Áreas da Computação</span></a></p></li>
<li><p>5.2. <a class="reference internal" href="#52-a-fronteira-da-pesquisa-e-o-futuro"><span class="xref myst">A Fronteira da Pesquisa e o Futuro</span></a></p></li>
<li><p>5.3. <a class="reference internal" href="#53-resumo-do-cap%C3%ADtulo-e-mapa-mental"><span class="xref myst">Resumo do Capítulo e Mapa Mental</span></a></p></li>
<li><p>5.4. <a class="reference internal" href="#54-refer%C3%AAncias-e-leituras-adicionais"><span class="xref myst">Referências e Leituras Adicionais</span></a></p></li>
</ul>
</li>
</ol>
</section>
<hr class="docutils" />
<section id="abertura-e-engajamento">
<h2>1. Abertura e Engajamento<a class="headerlink" href="#abertura-e-engajamento" title="Link to this heading">#</a></h2>
<section id="problema-motivador">
<h3>1.1. Problema Motivador<a class="headerlink" href="#problema-motivador" title="Link to this heading">#</a></h3>
<p>Imagine que você acabou de ser contratado como desenvolvedor em uma empresa de tecnologia promissora. No seu primeiro dia, você recebe a tarefa de adicionar uma nova funcionalidade ao sistema principal da empresa - um software de gestão bibliotecária que atende centenas de bibliotecas universitárias. Ao abrir o código, você se depara com um arquivo Python de 2.000 linhas, onde uma única classe chamada <code class="docutils literal notranslate"><span class="pre">BibliotecaManager</span></code> controla absolutamente tudo: cadastro de livros, gestão de usuários, cálculo de multas, geração de relatórios, envio de emails e até mesmo formatação de documentos para impressão.</p>
<p>Cada método tem mais de 100 linhas, variáveis têm nomes como <code class="docutils literal notranslate"><span class="pre">x1</span></code>, <code class="docutils literal notranslate"><span class="pre">temp</span></code> e <code class="docutils literal notranslate"><span class="pre">dados</span></code>, e para entender o que uma função faz, você precisa ler o código de outras dez funções. Pior ainda: não há testes automatizados, e toda mudança no código tem potencial para quebrar funcionalidades aparentemente não relacionadas. O último desenvolvedor que tentou adicionar uma funcionalidade simples - exibir a data de devolução prevista - acabou corrompendo o sistema de cálculo de multas, causando prejuízos financeiros significativos para a empresa.</p>
</section>
<section id="contexto-historico-e-relevancia-atual">
<h3>1.2. Contexto Histórico e Relevância Atual<a class="headerlink" href="#contexto-historico-e-relevancia-atual" title="Link to this heading">#</a></h3>
<p>Os princípios <strong>SOLID</strong> foram formulados e popularizados por <strong>Robert C. Martin</strong> (Uncle Bob) a partir de 2000, sintetizando décadas de experiência em design orientado a objetos. Simultaneamente, <strong>Kent Beck</strong> introduzia o conceito de <strong>código limpo</strong> e práticas como TDD (Test-Driven Development), enquanto <strong>Martin Fowler</strong> sistematizava técnicas de refatoração que hoje são pilares da engenharia de software moderna.</p>
<p>Os <strong>padrões de design</strong> (design patterns) foram catalogados pela famosa “Gang of Four” - <strong>Erich Gamma</strong>, <strong>Richard Helm</strong>, <strong>Ralph Johnson</strong> e <strong>John Vlissides</strong> - no livro “Design Patterns: Elements of Reusable Object-Oriented Software” (1994), estabelecendo um vocabulário comum para soluções arquiteturais recorrentes.</p>
<p><strong>Relevância Atual:</strong> Em 2025, esses princípios são mais cruciais do que nunca. Sistemas modernos como <strong>microserviços</strong>, <strong>arquiteturas serverless</strong>, <strong>inteligência artificial</strong> e <strong>blockchain</strong> dependem fundamentalmente de código bem estruturado para serem mantidos e escalados. Empresas como <strong>Google</strong>, <strong>Netflix</strong>, <strong>Amazon</strong> e <strong>Microsoft</strong> investem milhões em práticas de código limpo porque reconhecem que a velocidade de inovação está diretamente correlacionada à qualidade da base de código. Estudos recentes indicam que desenvolvedores passam <strong>70% do tempo lendo código</strong> e apenas 30% escrevendo - tornando a legibilidade não apenas uma questão estética, mas um imperativo econômico.</p>
</section>
</section>
<hr class="docutils" />
<section id="fundamentos-teoricos">
<h2>2. Fundamentos Teóricos<a class="headerlink" href="#fundamentos-teoricos" title="Link to this heading">#</a></h2>
<p>Antes de desenvolver a base teórica, analisamos a estrutura do conteúdo programático da aula e identificamos três blocos lógicos principais: <strong>1) Apresentação da Disciplina</strong>, <strong>2) Revisão dos Princípios de Boas Práticas</strong> (SOLID, DRY, YAGNI, KISS, Coesão e Acoplamento), e <strong>3) Padrões de Design</strong> (Strategy, Observer, Command, Factory Method, Singleton, Adapter). Cada bloco será desenvolvido iterativamente com profundidade teórica e rigor técnico adequados aos objetivos da disciplina.</p>
<section id="terminologia-essencial-e-definicoes-formais">
<h3><strong>2.1. Terminologia Essencial e Definições Formais</strong><a class="headerlink" href="#terminologia-essencial-e-definicoes-formais" title="Link to this heading">#</a></h3>
<section id="codigo-limpo">
<h4><strong>Código Limpo</strong><a class="headerlink" href="#codigo-limpo" title="Link to this heading">#</a></h4>
<p><strong>Definição Formal:</strong> Código limpo é um código que expressa claramente a intenção do programador, pode ser facilmente entendido, modificado e estendido por qualquer desenvolvedor competente (não apenas pelo autor original), minimiza a complexidade cognitiva necessária para compreensão e segue convenções consistentes que facilitam a manutenção.</p>
<p><strong>Analogia:</strong> Código limpo é como um texto acadêmico bem estruturado - tem introdução clara, desenvolvimento lógico, conclusões consistentes e referências precisas. Qualquer especialista na área consegue compreender, criticar e expandir o trabalho sem consultar o autor original.</p>
</section>
<section id="coesao">
<h4><strong>Coesão</strong><a class="headerlink" href="#coesao" title="Link to this heading">#</a></h4>
<p><strong>Definição Formal:</strong> Coesão mede o grau em que os elementos dentro de um módulo (classe, função ou pacote) trabalham colaborativamente para um propósito único e bem definido. Alta coesão indica que todos os elementos do módulo contribuem harmonicamente para uma única responsabilidade bem delimitada.</p>
<p><strong>Analogia:</strong> Uma equipe de cirurgia cardíaca tem alta coesão - cirurgião, anestesista, perfusionista e enfermeiros especializados têm papéis diferentes, mas todos trabalham coordenadamente para o mesmo objetivo específico: o sucesso da cirurgia cardíaca. Uma “equipe” formada por um cirurgião cardíaco, um chef de cozinha e um professor de física teria baixa coesão para qualquer objetivo prático.</p>
</section>
<section id="acoplamento">
<h4><strong>Acoplamento</strong><a class="headerlink" href="#acoplamento" title="Link to this heading">#</a></h4>
<p><strong>Definição Formal:</strong> Acoplamento mede o grau de interdependência entre diferentes módulos de software. Baixo acoplamento significa que mudanças em um módulo têm impacto mínimo e controlado em outros módulos, permitindo evolução independente e substituição de componentes.</p>
<p><strong>Analogia:</strong> Sistemas com baixo acoplamento são como apartamentos em um condomínio moderno - cada unidade tem instalações independentes (elétrica, hidráulica, internet), e problemas ou reformas em um apartamento não afetam diretamente os outros. Sistemas com alto acoplamento são como casas antigas com fiação elétrica compartilhada - mexer na instalação de um cômodo pode causar problemas em toda a residência.</p>
<blockquote>
<div><p><strong>Analogia para Entender SOLID</strong></p>
<p><strong>Imagine o funcionamento de um hospital de alta complexidade:</strong></p>
<ul class="simple">
<li><p><strong>S (Single Responsibility):</strong> Cada profissional tem UMA especialização bem definida - cardiologista só trata do coração, neurologista só do sistema nervoso. Nenhum médico tenta ser especialista em tudo simultaneamente.</p></li>
<li><p><strong>O (Open/Closed):</strong> O hospital pode adicionar novas especialidades (oncologia, geriatria) sem modificar o funcionamento das especialidades existentes. Novos departamentos se integram ao sistema sem quebrar protocolos estabelecidos.</p></li>
<li><p><strong>L (Liskov Substitution):</strong> Qualquer cardiologista qualificado pode substituir outro em plantão sem alterar o funcionamento do setor cardíaco. Pacientes continuam recebendo o mesmo padrão de atendimento.</p></li>
<li><p><strong>I (Interface Segregation):</strong> Enfermeiros não precisam saber realizar cirurgias, apenas os protocolos de cuidado pós-operatório. Cada profissional tem acesso apenas às informações necessárias para sua função específica.</p></li>
<li><p><strong>D (Dependency Inversion):</strong> Médicos trabalham com “protocolos de tratamento” padronizados em vez de métodos específicos, permitindo flexibilidade na escolha de medicamentos e procedimentos baseada em evidências atuais.</p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="estrutura-conceitual">
<h3><strong>2.2. Estrutura Conceitual</strong><a class="headerlink" href="#estrutura-conceitual" title="Link to this heading">#</a></h3>
<section id="principios-de-boas-praticas-base-cientifica-do-design">
<h4><strong>2.2.1. Princípios de Boas Práticas - Base Científica do Design</strong><a class="headerlink" href="#principios-de-boas-praticas-base-cientifica-do-design" title="Link to this heading">#</a></h4>
<p><strong>Subtítulo: SOLID - Os Cinco Pilares da Arquitetura Orientada a Objetos</strong></p>
<section id="single-responsibility-principle-srp">
<h5><strong>Single Responsibility Principle (SRP)</strong><a class="headerlink" href="#single-responsibility-principle-srp" title="Link to this heading">#</a></h5>
<p><strong>Teoria Detalhada:</strong> Uma classe deve ter apenas uma razão para mudar, ou seja, deve ter apenas uma responsabilidade ou motivação para ser modificada. O SRP não limita o número de métodos, mas sim o número de <strong>atores</strong> ou <strong>stakeholders</strong> que podem solicitar mudanças na classe.</p>
<p><strong>Definição Matemática:</strong> Para uma classe <span class="math notranslate nohighlight">\(C\)</span> com conjunto de responsabilidades <span class="math notranslate nohighlight">\(R = \{r_1, r_2, ..., r_n\}\)</span>, o SRP é satisfeito quando <span class="math notranslate nohighlight">\(|R| = 1\)</span>.</p>
<p><strong>Fluxograma de Identificação de Violação:</strong></p>
<div class="highlight-mermaid notranslate"><div class="highlight"><pre><span></span>graph TD
    A[Analise a Classe] --&gt; B{Consegue descrever sem usar &#39;E&#39; ou &#39;OU&#39;?}
    B --&gt;|Não| C[❌ Viola SRP]
    B --&gt;|Sim| D{Quantos atores diferentes podem pedir mudanças?}
    D --&gt;|\&gt; 1| C
    D --&gt;|1| E[✅ Satisfaz SRP]
</pre></div>
</div>
</section>
<section id="open-closed-principle-ocp">
<h5><strong>Open/Closed Principle (OCP)</strong><a class="headerlink" href="#open-closed-principle-ocp" title="Link to this heading">#</a></h5>
<p><strong>Teoria Detalhada:</strong> Entidades de software devem estar <strong>abertas para extensão</strong> (novos comportamentos) mas <strong>fechadas para modificação</strong> (código existente não deve ser alterado). Isso é alcançado através de <strong>abstrações</strong>, <strong>polimorfismo</strong> e <strong>injeção de dependência</strong>.</p>
<p><strong>Mecanismos de Implementação:</strong></p>
<ol class="arabic simple">
<li><p><strong>Herança + Template Method:</strong> Definir algoritmo base e permitir customização de steps específicos</p></li>
<li><p><strong>Composição + Strategy:</strong> Delegar comportamentos variáveis para objetos intercambiáveis</p></li>
<li><p><strong>Interfaces + Dependency Injection:</strong> Receber dependências abstratas externamente</p></li>
</ol>
<p><strong>Pseudocódigo OCP:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CLASSE</span> <span class="n">AbstractBehavior</span><span class="p">:</span>
    <span class="n">MÉTODO</span> <span class="n">ABSTRATO</span> <span class="n">executar</span><span class="p">()</span>

<span class="n">CLASSE</span> <span class="n">ConcreteBehavior1</span> <span class="n">HERDA</span> <span class="n">AbstractBehavior</span><span class="p">:</span>
    <span class="n">MÉTODO</span> <span class="n">executar</span><span class="p">():</span> <span class="o">//</span> <span class="n">implementação</span> <span class="n">específica</span> <span class="mi">1</span>

<span class="n">CLASSE</span> <span class="n">ConcreteBehavior2</span> <span class="n">HERDA</span> <span class="n">AbstractBehavior</span><span class="p">:</span>  
    <span class="n">MÉTODO</span> <span class="n">executar</span><span class="p">():</span> <span class="o">//</span> <span class="n">implementação</span> <span class="n">específica</span> <span class="mi">2</span>

<span class="n">CLASSE</span> <span class="n">Context</span><span class="p">:</span>
    <span class="n">CONSTRUTOR</span><span class="p">(</span><span class="n">behavior</span><span class="p">:</span> <span class="n">AbstractBehavior</span><span class="p">):</span>
        <span class="n">this</span><span class="o">.</span><span class="n">behavior</span> <span class="o">=</span> <span class="n">behavior</span>
    
    <span class="n">MÉTODO</span> <span class="n">processo</span><span class="p">():</span>
        <span class="o">//</span> <span class="n">Código</span> <span class="n">estável</span> <span class="o">-</span> <span class="n">nunca</span> <span class="n">muda</span>
        <span class="n">preparar</span><span class="p">()</span>
        <span class="n">behavior</span><span class="o">.</span><span class="n">executar</span><span class="p">()</span>  <span class="o">//</span> <span class="n">Comportamento</span> <span class="n">extensível</span>  
        <span class="n">finalizar</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="liskov-substitution-principle-lsp">
<h5><strong>Liskov Substitution Principle (LSP)</strong><a class="headerlink" href="#liskov-substitution-principle-lsp" title="Link to this heading">#</a></h5>
<p><strong>Teoria Detalhada:</strong> Objetos de uma superclasse devem ser substituíveis por objetos de suas subclasses sem alterar a <strong>correção</strong> do programa. LSP garante que a herança preserve as <strong>invariantes</strong>, <strong>pré-condições</strong> e <strong>pós-condições</strong> da superclasse.</p>
<p><strong>Condições Formais para LSP:</strong></p>
<ul class="simple">
<li><p><strong>Pré-condições:</strong> <span class="math notranslate nohighlight">\(Pre_{subclasse} \implies Pre_{superclasse}\)</span> (subclasses não podem fortalecer)</p></li>
<li><p><strong>Pós-condições:</strong> <span class="math notranslate nohighlight">\(Post_{superclasse} \implies Post_{subclasse}\)</span> (subclasses não podem enfraquecer)</p></li>
<li><p><strong>Invariantes:</strong> <span class="math notranslate nohighlight">\(Inv_{superclasse} \subseteq Inv_{subclasse}\)</span> (propriedades devem ser mantidas)</p></li>
</ul>
</section>
<section id="interface-segregation-principle-isp">
<h5><strong>Interface Segregation Principle (ISP)</strong><a class="headerlink" href="#interface-segregation-principle-isp" title="Link to this heading">#</a></h5>
<p><strong>Teoria Detalhada:</strong> Nenhum cliente deve ser forçado a depender de métodos que não utiliza. Interfaces grandes devem ser segmentadas em interfaces menores e mais específicas, aplicando o princípio da <strong>responsabilidade única</strong> ao nível de interfaces.</p>
<p><strong>Fórmula de Segregação:</strong> Para uma interface <span class="math notranslate nohighlight">\(I\)</span> com métodos <span class="math notranslate nohighlight">\(M = \{m_1, m_2, ..., m_n\}\)</span> e clientes <span class="math notranslate nohighlight">\(C = \{c_1, c_2, ..., c_k\}\)</span>, ISP é violado quando <span class="math notranslate nohighlight">\(\exists\, c_i \in C:\; \lvert M_{\text{usado por } c_i}\rvert &lt; \lvert M\rvert\)</span>.</p>
</section>
<section id="dependency-inversion-principle-dip">
<h5><strong>Dependency Inversion Principle (DIP)</strong><a class="headerlink" href="#dependency-inversion-principle-dip" title="Link to this heading">#</a></h5>
<p><strong>Teoria Detalhada:</strong> Módulos de alto nível não devem depender de módulos de baixo nível. Ambos devem depender de <strong>abstrações</strong>. Abstrações não devem depender de detalhes; detalhes devem depender de abstrações.</p>
<p><strong>Arquitetura DIP:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Camada de Aplicação (Alto Nível)
         ↕ (depende apenas de)
Camada de Interfaces/Abstrações  
         ↕ (implementada por)
Camada de Implementação (Baixo Nível)
</pre></div>
</div>
<p><strong>Subtítulo: Princípios Complementares - Qualidade e Simplicidade</strong></p>
</section>
<section id="dry-don-t-repeat-yourself">
<h5><strong>DRY (Don’t Repeat Yourself)</strong><a class="headerlink" href="#dry-don-t-repeat-yourself" title="Link to this heading">#</a></h5>
<p><strong>Teoria Detalhada:</strong> Cada pedaço de <strong>conhecimento</strong> (não código) deve ter uma representação única, autoritativa e não-ambígua no sistema. DRY foca em evitar duplicação de <strong>lógica de negócio</strong>, não necessariamente duplicação textual de código.</p>
<p><strong>Tipos de Duplicação:</strong></p>
<ol class="arabic simple">
<li><p><strong>Duplicação Inadvertida:</strong> Desenvolvedor não percebe a repetição existente</p></li>
<li><p><strong>Duplicação por Impaciência:</strong> Pressa leva a copiar código em vez de abstrair</p></li>
<li><p><strong>Duplicação Interdeveloper:</strong> Múltiplos desenvolvedores criam soluções similares</p></li>
<li><p><strong>Duplicação Acidental:</strong> Códigos similares que evoluirão independentemente</p></li>
</ol>
</section>
<section id="yagni-you-aren-t-gonna-need-it">
<h5><strong>YAGNI (You Aren’t Gonna Need It)</strong><a class="headerlink" href="#yagni-you-aren-t-gonna-need-it" title="Link to this heading">#</a></h5>
<p><strong>Teoria Detalhada:</strong> Não implemente funcionalidades baseadas em especulações sobre necessidades futuras. Adicione complexidade apenas quando há <strong>demanda atual e específica</strong>. YAGNI combate o <strong>over-engineering</strong> e <strong>premature optimization</strong>.</p>
<p><strong>Critérios para Violação YAGNI:</strong></p>
<ul class="simple">
<li><p>Código para requisitos não confirmados</p></li>
<li><p>Abstrações sem pelo menos 2 casos de uso atuais</p></li>
<li><p>Configurações para cenários hipotéticos</p></li>
<li><p>APIs “extensíveis” sem consumidores definidos</p></li>
</ul>
</section>
<section id="kiss-keep-it-simple-stupid">
<h5><strong>KISS (Keep It Simple, Stupid)</strong><a class="headerlink" href="#kiss-keep-it-simple-stupid" title="Link to this heading">#</a></h5>
<p><strong>Teoria Detalhada:</strong> A simplicidade deve ser um objetivo principal no design. A solução mais simples que resolve o problema é preferível à mais inteligente. Complexidade deve ser justificada por <strong>benefícios concretos</strong> e <strong>requisitos específicos</strong>.</p>
<p><strong>Heurísticas KISS:</strong></p>
<ul class="simple">
<li><p>Prefira código óbvio a código inteligente</p></li>
<li><p>Use a ferramenta mais simples adequada ao problema</p></li>
<li><p>Documente quando a complexidade for inevitável</p></li>
<li><p>Meça complexidade antes de otimizar</p></li>
</ul>
<p><strong>Subtítulo: Métricas de Coesão e Acoplamento - Quantificação da Qualidade</strong></p>
<p><strong>Classificação de Coesão (do menor ao maior nível):</strong></p>
<ol class="arabic simple">
<li><p><strong>Coincidental:</strong> Elementos sem relação lógica agrupados arbitrariamente</p></li>
<li><p><strong>Lógica:</strong> Elementos que fazem atividades similares mas não relacionadas</p></li>
<li><p><strong>Temporal:</strong> Elementos executados aproximadamente ao mesmo tempo</p></li>
<li><p><strong>Procedimental:</strong> Elementos que seguem uma sequência específica</p></li>
<li><p><strong>Comunicacional:</strong> Elementos que operam sobre os mesmos dados</p></li>
<li><p><strong>Sequencial:</strong> Saída de um elemento é entrada direta do próximo</p></li>
<li><p><strong>Funcional:</strong> Todos os elementos contribuem para uma única tarefa (ideal)</p></li>
</ol>
<p><strong>Classificação de Acoplamento (do maior ao menor nível):</strong></p>
<ol class="arabic simple">
<li><p><strong>Conteúdo:</strong> Um módulo modifica dados internos de outro (pior)</p></li>
<li><p><strong>Comum:</strong> Módulos compartilham dados através de variáveis globais</p></li>
<li><p><strong>Controle:</strong> Um módulo controla o fluxo interno de outro</p></li>
<li><p><strong>Estampa:</strong> Módulos compartilham estruturas de dados complexas</p></li>
<li><p><strong>Dados:</strong> Módulos compartilham dados apenas via parâmetros simples</p></li>
<li><p><strong>Mensagem:</strong> Comunicação via interfaces bem definidas (melhor)</p></li>
</ol>
</section>
</section>
<section id="padroes-de-design-solucoes-catalogadas-para-problemas-recorrentes">
<h4><strong>2.2.2. Padrões de Design - Soluções Catalogadas para Problemas Recorrentes</strong><a class="headerlink" href="#padroes-de-design-solucoes-catalogadas-para-problemas-recorrentes" title="Link to this heading">#</a></h4>
<p><strong>Subtítulo: Padrões Comportamentais - Gestão de Comunicação e Responsabilidades</strong></p>
<section id="strategy-pattern">
<h5><strong>Strategy Pattern</strong><a class="headerlink" href="#strategy-pattern" title="Link to this heading">#</a></h5>
<p><strong>Teoria Detalhada:</strong> Define uma família de algoritmos, encapsula cada um e os torna intercambiáveis em tempo de execução. Strategy permite que algoritmos variem independentemente dos clientes que os utilizam, implementando o <strong>Open/Closed Principle</strong> através de polimorfismo.</p>
<p><strong>Estrutura Formal:</strong></p>
<ul class="simple">
<li><p><strong>Context:</strong> Mantém referência para uma estratégia e delega trabalho</p></li>
<li><p><strong>Strategy (Interface):</strong> Interface comum para todas as estratégias concretas</p></li>
<li><p><strong>ConcreteStrategy:</strong> Implementações específicas de algoritmos</p></li>
</ul>
<p><strong>Casos de Uso Típicos:</strong></p>
<ul class="simple">
<li><p>Algoritmos de ordenação intercambiáveis</p></li>
<li><p>Estratégias de cálculo de impostos/descontos</p></li>
<li><p>Algoritmos de compressão de dados</p></li>
<li><p>Políticas de validação configuráveis</p></li>
</ul>
</section>
<section id="observer-pattern">
<h5><strong>Observer Pattern</strong><a class="headerlink" href="#observer-pattern" title="Link to this heading">#</a></h5>
<p><strong>Teoria Detalhada:</strong> Define dependência um-para-muitos entre objetos, de forma que quando um objeto muda de estado, todos seus dependentes são notificados automaticamente. Observer implementa <strong>baixo acoplamento</strong> entre subject e observers através de interfaces abstratas.</p>
<p><strong>Componentes Estruturais:</strong></p>
<ul class="simple">
<li><p><strong>Subject:</strong> Mantém lista de observers e os notifica sobre mudanças</p></li>
<li><p><strong>Observer:</strong> Interface para objetos que devem ser notificados</p></li>
<li><p><strong>ConcreteObserver:</strong> Implementações específicas de reação a notificações</p></li>
</ul>
</section>
<section id="command-pattern">
<h5><strong>Command Pattern</strong><a class="headerlink" href="#command-pattern" title="Link to this heading">#</a></h5>
<p><strong>Teoria Detalhada:</strong> Encapsula uma requisição como objeto, permitindo parametrizar clientes com diferentes requisições, enfileirar operações, registrar logs de operações e suportar undo/redo. Command transforma <strong>ações</strong> em <strong>objetos de primeira classe</strong>.</p>
<p><strong>Benefícios Arquiteturais:</strong></p>
<ul class="simple">
<li><p>Desacopla invocador de receptor</p></li>
<li><p>Permite composição de comandos (macro commands)</p></li>
<li><p>Facilita logging e auditoria</p></li>
<li><p>Habilita operações de undo/redo</p></li>
</ul>
<p><strong>Subtítulo: Padrões Criacionais - Controle Sofisticado de Instanciação</strong></p>
</section>
<section id="factory-method-pattern">
<h5><strong>Factory Method Pattern</strong><a class="headerlink" href="#factory-method-pattern" title="Link to this heading">#</a></h5>
<p><strong>Teoria Detalhada:</strong> Define interface para criar objetos, mas permite subclasses decidir qual classe instanciar. Factory Method delega a responsabilidade de criação para subclasses, seguindo o <strong>Dependency Inversion Principle</strong> e <strong>Open/Closed Principle</strong>.</p>
<p><strong>Motivação:</strong> Quando uma classe não pode antecipar a classe de objetos que deve criar, ou quando uma classe quer que suas subclasses especifiquem os objetos que criam.</p>
</section>
<section id="singleton-pattern">
<h5><strong>Singleton Pattern</strong><a class="headerlink" href="#singleton-pattern" title="Link to this heading">#</a></h5>
<p><strong>Teoria Detalhada:</strong> Garante que uma classe tenha apenas uma instância e fornece ponto de acesso global a ela. Singleton é útil quando exatamente um objeto é necessário para coordenar ações pelo sistema (logger, cache, connection pool).</p>
<p><strong>Considerações de Implementação:</strong></p>
<ul class="simple">
<li><p>Thread-safety em ambientes concorrentes</p></li>
<li><p>Lazy vs. eager initialization</p></li>
<li><p>Impacto na testabilidade (dificuldade de mock)</p></li>
<li><p>Alternativas: Dependency Injection containers</p></li>
</ul>
<p><strong>Subtítulo: Padrões Estruturais - Composição e Relacionamentos entre Classes</strong></p>
</section>
<section id="adapter-pattern">
<h5><strong>Adapter Pattern</strong><a class="headerlink" href="#adapter-pattern" title="Link to this heading">#</a></h5>
<p><strong>Teoria Detalhada:</strong> Permite que classes com interfaces incompatíveis trabalhem juntas envolvendo a interface de uma classe em outra interface esperada pelos clientes. Adapter resolve incompatibilidades sem modificar código existente.</p>
<p><strong>Duas Variantes:</strong></p>
<ul class="simple">
<li><p><strong>Object Adapter:</strong> Usa composição para adaptar interface</p></li>
<li><p><strong>Class Adapter:</strong> Usa herança múltipla (quando disponível na linguagem)</p></li>
</ul>
</section>
</section>
</section>
<section id="analise-quantitativa-metricas-de-qualidade-de-software">
<h3><strong>2.3. Análise Quantitativa - Métricas de Qualidade de Software</strong><a class="headerlink" href="#analise-quantitativa-metricas-de-qualidade-de-software" title="Link to this heading">#</a></h3>
<p>A qualidade arquitetural pode ser quantificada através de métricas específicas que relacionam coesão, acoplamento e complexidade:</p>
<section id="metrica-de-coesao-lcom-lack-of-cohesion-of-methods">
<h4><strong>Métrica de Coesão LCOM (Lack of Cohesion of Methods)</strong><a class="headerlink" href="#metrica-de-coesao-lcom-lack-of-cohesion-of-methods" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[LCOM = |P| - |Q|\]</div>
<p>Onde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P\)</span> = conjunto de pares de métodos que <strong>não compartilham</strong> atributos de instância</p></li>
<li><p><span class="math notranslate nohighlight">\(Q\)</span> = conjunto de pares de métodos que <strong>compartilham</strong> pelo menos um atributo de instância</p></li>
</ul>
<p><strong>Interpretação Prática:</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(LCOM = 0\)</span>: Coesão máxima (todos os métodos usam atributos comuns)</p></li>
<li><p><span class="math notranslate nohighlight">\(LCOM &gt; 0\)</span>: Baixa coesão, classe candidata à divisão</p></li>
<li><p><span class="math notranslate nohighlight">\(LCOM &lt; 0\)</span>: Indica compartilhamento excessivo de atributos</p></li>
</ul>
<p><strong>Exemplo de Cálculo:</strong>
Para uma classe com métodos <span class="math notranslate nohighlight">\(\{A, B, C\}\)</span> e atributos <span class="math notranslate nohighlight">\(\{x, y\}\)</span>:</p>
<ul class="simple">
<li><p>Se <span class="math notranslate nohighlight">\(A\)</span> usa <span class="math notranslate nohighlight">\(\{x\}\)</span>, <span class="math notranslate nohighlight">\(B\)</span> usa <span class="math notranslate nohighlight">\(\{y\}\)</span>, <span class="math notranslate nohighlight">\(C\)</span> usa <span class="math notranslate nohighlight">\(\{x,y\}\)</span></p></li>
<li><p>Pares que não compartilham: <span class="math notranslate nohighlight">\(P = \{(A,B)\} \Rightarrow |P| = 1\)</span></p></li>
<li><p>Pares que compartilham: <span class="math notranslate nohighlight">\(Q = \{(A,C), (B,C)\} \Rightarrow |Q| = 2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(LCOM = 1 - 2 = -1\)</span> → Coesão razoável</p></li>
</ul>
</section>
<section id="metrica-de-instabilidade-acoplamento-eferente-vs-aferente">
<h4><strong>Métrica de Instabilidade (Acoplamento Eferente vs. Aferente)</strong><a class="headerlink" href="#metrica-de-instabilidade-acoplamento-eferente-vs-aferente" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[I = \frac{C_e}{C_a + C_e}\]</div>
<p>Onde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(C_e\)</span> = Acoplamento eferente (dependências que <strong>saem</strong> do módulo)</p></li>
<li><p><span class="math notranslate nohighlight">\(C_a\)</span> = Acoplamento aferente (dependências que <strong>entram</strong> no módulo)</p></li>
<li><p><span class="math notranslate nohighlight">\(I \in [0, 1]\)</span></p></li>
</ul>
<p><strong>Interpretação Estratégica:</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(I = 0\)</span>: Módulo completamente estável (muitas dependências entrando, nenhuma saindo)</p></li>
<li><p><span class="math notranslate nohighlight">\(I = 1\)</span>: Módulo completamente instável (muitas dependências saindo, nenhuma entrando)</p></li>
<li><p><span class="math notranslate nohighlight">\(I \approx 0.5\)</span>: Equilíbrio entre estabilidade e responsabilidade</p></li>
</ul>
</section>
<section id="complexidade-ciclomatica-de-mccabe">
<h4><strong>Complexidade Ciclomática de McCabe</strong><a class="headerlink" href="#complexidade-ciclomatica-de-mccabe" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[V(G) = E - N + 2P\]</div>
<p>Onde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E\)</span> = número de <strong>arestas</strong> no grafo de fluxo de controle</p></li>
<li><p><span class="math notranslate nohighlight">\(N\)</span> = número de <strong>nós</strong> no grafo</p></li>
<li><p><span class="math notranslate nohighlight">\(P\)</span> = número de <strong>componentes conectados</strong></p></li>
</ul>
<p><strong>Guidelines de Interpretação:</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(V(G) \leq 10\)</span>: Complexidade baixa, código facilmente testável</p></li>
<li><p><span class="math notranslate nohighlight">\(10 &lt; V(G) \leq 20\)</span>: Complexidade moderada, monitorar crescimento</p></li>
<li><p><span class="math notranslate nohighlight">\(V(G) &gt; 20\)</span>: Complexidade alta, refatoração <strong>obrigatória</strong></p></li>
</ul>
</section>
</section>
<section id="analise-critica">
<h3><strong>2.4. Análise Crítica</strong><a class="headerlink" href="#analise-critica" title="Link to this heading">#</a></h3>
<section id="limitacoes-e-trade-offs-dos-principios">
<h4><strong>Limitações e Trade-offs dos Princípios</strong><a class="headerlink" href="#limitacoes-e-trade-offs-dos-principios" title="Link to this heading">#</a></h4>
<p><strong>Over-Engineering e Pattern Fever:</strong> A aplicação excessiva de padrões pode criar <strong>complexidade acidental</strong> - complexidade que não deriva do domínio do problema, mas das soluções escolhidas. Desenvolvedores podem cair na armadilha de usar padrões complexos (como Abstract Factory) para problemas simples que uma função resolveria adequadamente.</p>
<p><strong>Performance vs. Flexibilidade:</strong> Padrões como Strategy introduzem <strong>indireção</strong> (chamada de método virtual) que tem custo computacional. Em loops críticos ou sistemas de alta frequência, essa indireção pode ser significativa. O trade-off deve ser avaliado: flexibilidade arquitetural versus performance bruta.</p>
<p><strong>Curva de Aprendizado e Consenso de Equipe:</strong> Implementação adequada de boas práticas exige <strong>experiência contextual</strong>. Desenvolvedores iniciantes podem aplicar princípios mecanicamente, criando abstrações prematuras ou violando princípios por falta de compreensão das implicações. <strong>Consenso de equipe</strong> sobre quando e como aplicar cada princípio é crucial.</p>
<p><strong>Contexto Determina Aplicabilidade:</strong> Nem todos os princípios se aplicam universalmente. <strong>Scripts de análise de dados</strong> podem não precisar da mesma arquitetura que <strong>sistemas críticos de missão</strong>. <strong>Prototipagem rápida</strong> pode priorizar velocidade sobre estrutura arquitetural.</p>
</section>
<section id="faq-perguntas-frequentes-e-armadilhas-comuns">
<h4><strong>FAQ - Perguntas Frequentes e Armadilhas Comuns</strong><a class="headerlink" href="#faq-perguntas-frequentes-e-armadilhas-comuns" title="Link to this heading">#</a></h4>
<p><strong>Q: Quando conscientemente quebrar DRY?</strong>
<strong>A:</strong> Quebre DRY quando a “duplicação” é <strong>coincidental</strong> - dois códigos similares que atendem contextos diferentes e evoluirão independentemente. Prefira “duplicação controlada” à “abstração errada” que força acoplamento artificial entre domínios distintos.</p>
<p><strong>Q: Como diagnosticar violação de SRP em código legado?</strong><br />
<strong>A:</strong> Aplique o <strong>teste da descrição</strong>: consegue descrever a classe sem usar “E” ou “OU”? Conte quantos <strong>atores diferentes</strong> (stakeholders) podem solicitar mudanças na classe. Se for mais de um, há violação de SRP.</p>
<p><strong>Q: Padrões de design sempre justificam a complexidade adicional?</strong>
<strong>A:</strong> Não. Padrões são <strong>soluções para problemas específicos</strong>. Use padrões quando o problema que eles resolvem está <strong>demonstravelmente presente</strong>. Implementar Strategy para 2 algoritmos fixos pode ser over-engineering; implemente quando há evidência de necessidade de extensibilidade.</p>
<p><strong>Q: Como equilibrar YAGNI com arquitetura extensível?</strong>
<strong>A:</strong> Crie <strong>pontos de extensão</strong> baseados em <strong>requisitos atuais</strong>, não especulações. Implemente abstrações quando você tem <strong>pelo menos 2 casos de uso concretos</strong>. Use interfaces para definir contratos sem implementar todas as variações especulativas.</p>
<p><strong>Q: Qual priorizar: performance ou boas práticas?</strong>
<strong>A:</strong> <strong>Primeira regra:</strong> faça funcionar corretamente (boas práticas), depois otimize se necessário. <strong>Profile primeiro:</strong> 90% dos problemas de performance vêm de 10% do código. Identifique gargalos reais antes de sacrificar legibilidade e manutenibilidade.</p>
</section>
<section id="tabela-comparativa-paradigmas-e-suas-implicacoes">
<h4><strong>Tabela Comparativa: Paradigmas e Suas Implicações</strong><a class="headerlink" href="#tabela-comparativa-paradigmas-e-suas-implicacoes" title="Link to this heading">#</a></h4>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Aspecto</p></th>
<th class="head"><p>Procedural</p></th>
<th class="head"><p>OOP Básica</p></th>
<th class="head"><p>OOP + Boas Práticas</p></th>
<th class="head"><p>Funcional</p></th>
<th class="head"><p>Híbrido Moderno</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Modificabilidade</strong></p></td>
<td><p>Baixa</p></td>
<td><p>Média</p></td>
<td><p>Alta</p></td>
<td><p>Alta</p></td>
<td><p>Muito Alta</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Testabilidade</strong></p></td>
<td><p>Baixa</p></td>
<td><p>Média</p></td>
<td><p>Muito Alta</p></td>
<td><p>Alta</p></td>
<td><p>Muito Alta</p></td>
</tr>
<tr class="row-even"><td><p><strong>Reusabilidade</strong></p></td>
<td><p>Baixa</p></td>
<td><p>Média</p></td>
<td><p>Alta</p></td>
<td><p>Muito Alta</p></td>
<td><p>Muito Alta</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Complexidade Inicial</strong></p></td>
<td><p>Baixa</p></td>
<td><p>Média</p></td>
<td><p>Alta</p></td>
<td><p>Muito Alta</p></td>
<td><p>Alta</p></td>
</tr>
<tr class="row-even"><td><p><strong>Performance Bruta</strong></p></td>
<td><p>Alta</p></td>
<td><p>Média</p></td>
<td><p>Média-Baixa</p></td>
<td><p>Variável</p></td>
<td><p>Otimizável</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Paralelização</strong></p></td>
<td><p>Difícil</p></td>
<td><p>Difícil</p></td>
<td><p>Média</p></td>
<td><p>Fácil</p></td>
<td><p>Fácil</p></td>
</tr>
<tr class="row-even"><td><p><strong>Debugging</strong></p></td>
<td><p>Fácil</p></td>
<td><p>Médio</p></td>
<td><p>Médio</p></td>
<td><p>Difícil</p></td>
<td><p>Médio</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Adequação para Equipes</strong></p></td>
<td><p>Baixa</p></td>
<td><p>Média</p></td>
<td><p>Alta</p></td>
<td><p>Média</p></td>
<td><p>Alta</p></td>
</tr>
<tr class="row-even"><td><p><strong>Curva de Aprendizado</strong></p></td>
<td><p>Baixa</p></td>
<td><p>Média</p></td>
<td><p>Alta</p></td>
<td><p>Muito Alta</p></td>
<td><p>Alta</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="aplicacao-pratica-e-implementacao">
<h2>3. Aplicação Prática e Implementação<a class="headerlink" href="#aplicacao-pratica-e-implementacao" title="Link to this heading">#</a></h2>
<section id="estudo-de-caso-guiado">
<h3>3.1. Estudo de Caso Guiado<a class="headerlink" href="#estudo-de-caso-guiado" title="Link to this heading">#</a></h3>
<p>Vamos desenvolver um sistema de gestão bibliotecária aplicando progressivamente todos os princípios de boas práticas e padrões de design estudados. O sistema começará como uma implementação problemática e será refatorado passo a passo.</p>
<section id="passo-1-analise-do-problema">
<h4><strong>Passo 1: Análise do Problema</strong><a class="headerlink" href="#passo-1-analise-do-problema" title="Link to this heading">#</a></h4>
<p><strong>Requisitos do Sistema:</strong></p>
<ul class="simple">
<li><p>Gerenciar livros (cadastro, busca, empréstimo, devolução)</p></li>
<li><p>Controlar usuários (bibliotecários e leitores)</p></li>
<li><p>Calcular multas por atraso</p></li>
<li><p>Gerar relatórios de empréstimos</p></li>
<li><p>Notificar usuários sobre prazos</p></li>
</ul>
</section>
<section id="passo-2-implementacao-inicial-problematica">
<h4><strong>Passo 2: Implementação Inicial Problemática</strong><a class="headerlink" href="#passo-2-implementacao-inicial-problematica" title="Link to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ANTES: Violação de múltiplos princípios</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BibliotecaManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    PROBLEMAS EVIDENTES:</span>
<span class="sd">    - Viola SRP: uma classe fazendo tudo</span>
<span class="sd">    - Alto acoplamento: mudanças afetam toda a classe</span>
<span class="sd">    - Baixa coesão: métodos com responsabilidades diferentes</span>
<span class="sd">    - Viola OCP: adicionar novos tipos requer modificar a classe</span>
<span class="sd">    - Código duplicado (viola DRY)</span>
<span class="sd">    - Complexidade desnecessária (viola KISS)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">livros</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">usuarios</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emprestimos</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">cadastrar_livro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">titulo</span><span class="p">,</span> <span class="n">autor</span><span class="p">,</span> <span class="n">isbn</span><span class="p">):</span>
        <span class="c1"># Validação misturada com lógica de negócio</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">titulo</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">titulo</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Título inválido!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="c1"># Lógica de persistência misturada</span>
        <span class="n">novo_livro</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">livros</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;titulo&#39;</span><span class="p">:</span> <span class="n">titulo</span><span class="p">,</span>
            <span class="s1">&#39;autor&#39;</span><span class="p">:</span> <span class="n">autor</span><span class="p">,</span>
            <span class="s1">&#39;isbn&#39;</span><span class="p">:</span> <span class="n">isbn</span><span class="p">,</span>
            <span class="s1">&#39;disponivel&#39;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">livros</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">novo_livro</span><span class="p">)</span>
        
        <span class="c1"># Formatação de saída misturada</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Livro &#39;</span><span class="si">{</span><span class="n">titulo</span><span class="si">}</span><span class="s2">&#39; cadastrado com sucesso!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">emprestar_livro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livro_id</span><span class="p">,</span> <span class="n">usuario_id</span><span class="p">):</span>
        <span class="c1"># Busca de livro com lógica duplicada</span>
        <span class="n">livro</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">livros</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">livro_id</span><span class="p">:</span>
                <span class="n">livro</span> <span class="o">=</span> <span class="n">l</span>
                <span class="k">break</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">livro</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Livro não encontrado!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="c1"># Busca de usuário com lógica duplicada</span>
        <span class="n">usuario</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">usuarios</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">u</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">usuario_id</span><span class="p">:</span>
                <span class="n">usuario</span> <span class="o">=</span> <span class="n">u</span>
                <span class="k">break</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">usuario</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Usuário não encontrado!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="c1"># Validação de disponibilidade</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">livro</span><span class="p">[</span><span class="s1">&#39;disponivel&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Livro não disponível!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="c1"># Cálculo de data de devolução hardcoded</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
        <span class="n">data_emprestimo</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">data_devolucao</span> <span class="o">=</span> <span class="n">data_emprestimo</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        
        <span class="c1"># Criação do empréstimo</span>
        <span class="n">emprestimo</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">emprestimos</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;livro_id&#39;</span><span class="p">:</span> <span class="n">livro_id</span><span class="p">,</span>
            <span class="s1">&#39;usuario_id&#39;</span><span class="p">:</span> <span class="n">usuario_id</span><span class="p">,</span>
            <span class="s1">&#39;data_emprestimo&#39;</span><span class="p">:</span> <span class="n">data_emprestimo</span><span class="p">,</span>
            <span class="s1">&#39;data_devolucao&#39;</span><span class="p">:</span> <span class="n">data_devolucao</span><span class="p">,</span>
            <span class="s1">&#39;devolvido&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">emprestimos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">emprestimo</span><span class="p">)</span>
        <span class="n">livro</span><span class="p">[</span><span class="s1">&#39;disponivel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Empréstimo realizado! Devolução: </span><span class="si">{</span><span class="n">data_devolucao</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">calcular_multa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo_id</span><span class="p">):</span>
        <span class="c1"># Busca com lógica duplicada novamente</span>
        <span class="n">emprestimo</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">emprestimos</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">emprestimo_id</span><span class="p">:</span>
                <span class="n">emprestimo</span> <span class="o">=</span> <span class="n">e</span>
                <span class="k">break</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">emprestimo</span> <span class="ow">or</span> <span class="n">emprestimo</span><span class="p">[</span><span class="s1">&#39;devolvido&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="mi">0</span>
        
        <span class="c1"># Cálculo de multa hardcoded</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
        <span class="n">data_atual</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">data_atual</span> <span class="o">&gt;</span> <span class="n">emprestimo</span><span class="p">[</span><span class="s1">&#39;data_devolucao&#39;</span><span class="p">]:</span>
            <span class="n">dias_atraso</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_atual</span> <span class="o">-</span> <span class="n">emprestimo</span><span class="p">[</span><span class="s1">&#39;data_devolucao&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">days</span>
            <span class="n">multa</span> <span class="o">=</span> <span class="n">dias_atraso</span> <span class="o">*</span> <span class="mf">2.0</span>  <span class="c1"># R$ 2,00 por dia</span>
            <span class="k">return</span> <span class="n">multa</span>
        
        <span class="k">return</span> <span class="mi">0</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">gerar_relatorio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Formatação misturada com lógica de negócio</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== RELATÓRIO DE EMPRÉSTIMOS ===&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">emp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">emprestimos</span><span class="p">:</span>
            <span class="n">livro</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">livros</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">emp</span><span class="p">[</span><span class="s1">&#39;livro_id&#39;</span><span class="p">]:</span>
                    <span class="n">livro</span> <span class="o">=</span> <span class="n">l</span>
                    <span class="k">break</span>
            
            <span class="n">usuario</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">usuarios</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">u</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">emp</span><span class="p">[</span><span class="s1">&#39;usuario_id&#39;</span><span class="p">]:</span>
                    <span class="n">usuario</span> <span class="o">=</span> <span class="n">u</span>
                    <span class="k">break</span>
            
            <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;Devolvido&quot;</span> <span class="k">if</span> <span class="n">emp</span><span class="p">[</span><span class="s1">&#39;devolvido&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;Em andamento&quot;</span>
            <span class="n">multa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calcular_multa</span><span class="p">(</span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Livro: </span><span class="si">{</span><span class="n">livro</span><span class="p">[</span><span class="s1">&#39;titulo&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">livro</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Usuário: </span><span class="si">{</span><span class="n">usuario</span><span class="p">[</span><span class="s1">&#39;nome&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">usuario</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Multa: R$ </span><span class="si">{</span><span class="n">multa</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="passo-3-refatoracao-aplicando-srp">
<h4><strong>Passo 3: Refatoração Aplicando SRP</strong><a class="headerlink" href="#passo-3-refatoracao-aplicando-srp" title="Link to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>

<span class="c1"># DEPOIS: Aplicando Single Responsibility Principle</span>
<span class="c1"># Cada classe tem uma única responsabilidade</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Livro</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    RESPONSABILIDADE: Representar um livro no sistema.</span>
<span class="sd">    BENEFÍCIO: Encapsula dados do livro de forma clara e imutável.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">titulo</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">autor</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">isbn</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">disponivel</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">marcar_emprestado</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Marca o livro como emprestado.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disponivel</span> <span class="o">=</span> <span class="kc">False</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">marcar_disponivel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Marca o livro como disponível.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disponivel</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Usuario</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    RESPONSABILIDADE: Representar um usuário do sistema.</span>
<span class="sd">    BENEFÍCIO: Separação clara entre dados de usuário e lógica de negócio.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">nome</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">tipo</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># &#39;leitor&#39; ou &#39;bibliotecario&#39;</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Emprestimo</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    RESPONSABILIDADE: Representar um empréstimo no sistema.</span>
<span class="sd">    BENEFÍCIO: Encapsula toda informação relevante a um empréstimo.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">livro_id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">usuario_id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">data_emprestimo</span><span class="p">:</span> <span class="n">datetime</span>
    <span class="n">data_devolucao</span><span class="p">:</span> <span class="n">datetime</span>
    <span class="n">devolvido</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">marcar_devolvido</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Marca o empréstimo como devolvido.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">devolvido</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ValidadorLivro</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    RESPONSABILIDADE: Validar dados de livros.</span>
<span class="sd">    BENEFÍCIO: Centraliza todas as regras de validação de livros.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validar_titulo</span><span class="p">(</span><span class="n">titulo</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Valida se o título do livro está em formato adequado.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        titulo : str</span>
<span class="sd">            Título do livro a ser validado.</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True se o título é válido, False caso contrário.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">titulo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">titulo</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">&gt;=</span> <span class="mi">2</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validar_isbn</span><span class="p">(</span><span class="n">isbn</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Valida se o ISBN está em formato básico adequado.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        isbn : str</span>
<span class="sd">            ISBN a ser validado.</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True se o ISBN é válido, False caso contrário.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">isbn_limpo</span> <span class="o">=</span> <span class="n">isbn</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">isbn_limpo</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span> <span class="ow">and</span> <span class="n">isbn_limpo</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CalculadoraMulta</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    RESPONSABILIDADE: Calcular multas por atraso.</span>
<span class="sd">    BENEFÍCIO: Centraliza e isola a lógica de cálculo de multas.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valor_por_dia</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Inicializa o calculador com valor de multa por dia.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        valor_por_dia : float</span>
<span class="sd">            Valor da multa por dia de atraso.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valor_por_dia</span> <span class="o">=</span> <span class="n">valor_por_dia</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">calcular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">,</span> <span class="n">data_atual</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcula a multa para um empréstimo.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        emprestimo : Emprestimo</span>
<span class="sd">            Empréstimo para calcular a multa.</span>
<span class="sd">        data_atual : Optional[datetime]</span>
<span class="sd">            Data atual para cálculo. Se None, usa datetime.now().</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Valor da multa em reais.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">emprestimo</span><span class="o">.</span><span class="n">devolvido</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        
        <span class="k">if</span> <span class="n">data_atual</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data_atual</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">data_atual</span> <span class="o">&lt;=</span> <span class="n">emprestimo</span><span class="o">.</span><span class="n">data_devolucao</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        
        <span class="n">dias_atraso</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_atual</span> <span class="o">-</span> <span class="n">emprestimo</span><span class="o">.</span><span class="n">data_devolucao</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>
        <span class="k">return</span> <span class="n">dias_atraso</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">valor_por_dia</span>

<span class="k">class</span><span class="w"> </span><span class="nc">RepositorioLivros</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    RESPONSABILIDADE: Gerenciar persistência de livros.</span>
<span class="sd">    BENEFÍCIO: Isola a lógica de acesso a dados.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_livros</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Livro</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_proximo_id</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">adicionar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livro</span><span class="p">:</span> <span class="n">Livro</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adiciona um livro ao repositório.&quot;&quot;&quot;</span>
        <span class="n">livro</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_proximo_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_proximo_id</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_livros</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">livro</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">buscar_por_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livro_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Livro</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Busca um livro pelo ID.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">livro</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_livros</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">livro</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">livro_id</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">livro</span>
        <span class="k">return</span> <span class="kc">None</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">listar_disponiveis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Livro</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Lista todos os livros disponíveis.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">livro</span> <span class="k">for</span> <span class="n">livro</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_livros</span> <span class="k">if</span> <span class="n">livro</span><span class="o">.</span><span class="n">disponivel</span><span class="p">]</span>

<span class="k">class</span><span class="w"> </span><span class="nc">GeradorRelatorio</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    RESPONSABILIDADE: Gerar relatórios do sistema.</span>
<span class="sd">    BENEFÍCIO: Separa formatação e apresentação da lógica de negócio.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">repo_livros</span><span class="p">:</span> <span class="n">RepositorioLivros</span><span class="p">,</span> 
                 <span class="n">repo_usuarios</span><span class="p">:</span> <span class="s1">&#39;RepositorioUsuarios&#39;</span><span class="p">,</span>
                 <span class="n">calculadora_multa</span><span class="p">:</span> <span class="n">CalculadoraMulta</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repo_livros</span> <span class="o">=</span> <span class="n">repo_livros</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repo_usuarios</span> <span class="o">=</span> <span class="n">repo_usuarios</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculadora_multa</span> <span class="o">=</span> <span class="n">calculadora_multa</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">gerar_relatorio_emprestimos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimos</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Emprestimo</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gera relatório formatado de empréstimos.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        emprestimos : List[Emprestimo]</span>
<span class="sd">            Lista de empréstimos para incluir no relatório.</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Relatório formatado como string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">linhas</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;=== RELATÓRIO DE EMPRÉSTIMOS ===&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">emp</span> <span class="ow">in</span> <span class="n">emprestimos</span><span class="p">:</span>
            <span class="n">livro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repo_livros</span><span class="o">.</span><span class="n">buscar_por_id</span><span class="p">(</span><span class="n">emp</span><span class="o">.</span><span class="n">livro_id</span><span class="p">)</span>
            <span class="n">usuario</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repo_usuarios</span><span class="o">.</span><span class="n">buscar_por_id</span><span class="p">(</span><span class="n">emp</span><span class="o">.</span><span class="n">usuario_id</span><span class="p">)</span>
            <span class="n">multa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculadora_multa</span><span class="o">.</span><span class="n">calcular</span><span class="p">(</span><span class="n">emp</span><span class="p">)</span>
            
            <span class="n">linhas</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
                <span class="sa">f</span><span class="s2">&quot;Empréstimo ID: </span><span class="si">{</span><span class="n">emp</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;Livro: </span><span class="si">{</span><span class="n">livro</span><span class="o">.</span><span class="n">titulo</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">livro</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;Usuário: </span><span class="si">{</span><span class="n">usuario</span><span class="o">.</span><span class="n">nome</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">usuario</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;Data Empréstimo: </span><span class="si">{</span><span class="n">emp</span><span class="o">.</span><span class="n">data_emprestimo</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;Data Devolução: </span><span class="si">{</span><span class="n">emp</span><span class="o">.</span><span class="n">data_devolucao</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;Status: </span><span class="si">{</span><span class="s1">&#39;Devolvido&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">emp</span><span class="o">.</span><span class="n">devolvido</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Em andamento&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;Multa: R$ </span><span class="si">{</span><span class="n">multa</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span>
            <span class="p">])</span>
        
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">linhas</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="passo-4-aplicando-open-closed-principle">
<h4><strong>Passo 4: Aplicando Open/Closed Principle</strong><a class="headerlink" href="#passo-4-aplicando-open-closed-principle" title="Link to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># CONCEITO: Open/Closed Principle</span>
<span class="c1"># Classes abertas para extensão, fechadas para modificação</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CalculadoraMultaBase</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CONCEITO: Abstração para diferentes tipos de cálculo de multa.</span>
<span class="sd">    BENEFÍCIO: Permite adicionar novos tipos sem modificar código existente.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">calcular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">,</span> <span class="n">data_atual</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calcula multa para um empréstimo.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MultaLinear</span><span class="p">(</span><span class="n">CalculadoraMultaBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    IMPLEMENTAÇÃO: Multa linear por dia de atraso.</span>
<span class="sd">    USO: Para usuários regulares.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valor_por_dia</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valor_por_dia</span> <span class="o">=</span> <span class="n">valor_por_dia</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">calcular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">,</span> <span class="n">data_atual</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">emprestimo</span><span class="o">.</span><span class="n">devolvido</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        
        <span class="k">if</span> <span class="n">data_atual</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data_atual</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">data_atual</span> <span class="o">&lt;=</span> <span class="n">emprestimo</span><span class="o">.</span><span class="n">data_devolucao</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        
        <span class="n">dias_atraso</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_atual</span> <span class="o">-</span> <span class="n">emprestimo</span><span class="o">.</span><span class="n">data_devolucao</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>
        <span class="k">return</span> <span class="n">dias_atraso</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">valor_por_dia</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MultaProgressiva</span><span class="p">(</span><span class="n">CalculadoraMultaBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    IMPLEMENTAÇÃO: Multa progressiva (aumenta com o tempo).</span>
<span class="sd">    USO: Para desencorajar atrasos longos.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valor_inicial</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">fator_progressao</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valor_inicial</span> <span class="o">=</span> <span class="n">valor_inicial</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fator_progressao</span> <span class="o">=</span> <span class="n">fator_progressao</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">calcular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">,</span> <span class="n">data_atual</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">emprestimo</span><span class="o">.</span><span class="n">devolvido</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        
        <span class="k">if</span> <span class="n">data_atual</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data_atual</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">data_atual</span> <span class="o">&lt;=</span> <span class="n">emprestimo</span><span class="o">.</span><span class="n">data_devolucao</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        
        <span class="n">dias_atraso</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_atual</span> <span class="o">-</span> <span class="n">emprestimo</span><span class="o">.</span><span class="n">data_devolucao</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>
        
        <span class="c1"># Fórmula progressiva: valor_inicial * (fator^dias)</span>
        <span class="n">multa_total</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">dia</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dias_atraso</span><span class="p">):</span>
            <span class="n">multa_dia</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valor_inicial</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fator_progressao</span> <span class="o">**</span> <span class="n">dia</span><span class="p">)</span>
            <span class="n">multa_total</span> <span class="o">+=</span> <span class="n">multa_dia</span>
        
        <span class="k">return</span> <span class="n">multa_total</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MultaSemMulta</span><span class="p">(</span><span class="n">CalculadoraMultaBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    IMPLEMENTAÇÃO: Sem multa (para usuários especiais).</span>
<span class="sd">    USO: Para professores, funcionários ou períodos promocionais.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">calcular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">,</span> <span class="n">data_atual</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>

<span class="c1"># BENEFÍCIO DO OCP: Para adicionar um novo tipo de multa,</span>
<span class="c1"># criamos uma nova classe sem modificar as existentes</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MultaComDesconto</span><span class="p">(</span><span class="n">CalculadoraMultaBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NOVA IMPLEMENTAÇÃO: Multa com desconto baseado em histórico.</span>
<span class="sd">    EXTENSÃO: Adicionada sem modificar código existente.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">calculadora_base</span><span class="p">:</span> <span class="n">CalculadoraMultaBase</span><span class="p">,</span> <span class="n">desconto_percentual</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculadora_base</span> <span class="o">=</span> <span class="n">calculadora_base</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desconto_percentual</span> <span class="o">=</span> <span class="n">desconto_percentual</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">calcular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">,</span> <span class="n">data_atual</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">multa_base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculadora_base</span><span class="o">.</span><span class="n">calcular</span><span class="p">(</span><span class="n">emprestimo</span><span class="p">,</span> <span class="n">data_atual</span><span class="p">)</span>
        <span class="n">desconto</span> <span class="o">=</span> <span class="n">multa_base</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">desconto_percentual</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">multa_base</span> <span class="o">-</span> <span class="n">desconto</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="exemplos-de-codigo-comentado">
<h3>3.2. Exemplos de Código Comentado<a class="headerlink" href="#exemplos-de-codigo-comentado" title="Link to this heading">#</a></h3>
<section id="implementacao-do-padrao-strategy">
<h4><strong>Implementação do Padrão Strategy</strong><a class="headerlink" href="#implementacao-do-padrao-strategy" title="Link to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Protocol</span>

<span class="c1"># PADRÃO: Strategy</span>
<span class="c1"># PROBLEMA: Diferentes algoritmos de busca de livros</span>
<span class="c1"># SOLUÇÃO: Estratégias intercambiáveis de busca</span>

<span class="k">class</span><span class="w"> </span><span class="nc">EstrategiaBusca</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    INTERFACE: Define contrato para estratégias de busca.</span>
<span class="sd">    BENEFÍCIO: Permite trocar algoritmos de busca em tempo de execução.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">buscar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livros</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Livro</span><span class="p">],</span> <span class="n">termo</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Livro</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Busca livros usando a estratégia específica.&quot;&quot;&quot;</span>
        <span class="o">...</span>

<span class="k">class</span><span class="w"> </span><span class="nc">BuscaPorTitulo</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ESTRATÉGIA CONCRETA: Busca por título exato.</span>
<span class="sd">    CASO DE USO: Quando o usuário sabe o título completo.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">buscar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livros</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Livro</span><span class="p">],</span> <span class="n">termo</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Livro</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Busca livros por título exato (case-insensitive).</span>
<span class="sd">        </span>
<span class="sd">        ALGORITMO: Comparação direta com normalização.</span>
<span class="sd">        COMPLEXIDADE: O(n) onde n é o número de livros.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">termo_normalizado</span> <span class="o">=</span> <span class="n">termo</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">resultado</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">livro</span> <span class="ow">in</span> <span class="n">livros</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">livro</span><span class="o">.</span><span class="n">titulo</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">termo_normalizado</span><span class="p">:</span>
                <span class="n">resultado</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">livro</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">resultado</span>

<span class="k">class</span><span class="w"> </span><span class="nc">BuscaPorTituloSimilar</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ESTRATÉGIA CONCRETA: Busca por similaridade de título.</span>
<span class="sd">    CASO DE USO: Busca tolerante a erros de digitação.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Inicializa busca com threshold de similaridade.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        threshold : float</span>
<span class="sd">            Valor entre 0 e 1 para similaridade mínima.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">buscar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livros</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Livro</span><span class="p">],</span> <span class="n">termo</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Livro</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Busca livros por similaridade usando algoritmo de Levenshtein.</span>
<span class="sd">        </span>
<span class="sd">        ALGORITMO: Distância de edição normalizada.</span>
<span class="sd">        COMPLEXIDADE: O(n*m*k) onde n=livros, m=len(titulo), k=len(termo).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">calcular_similaridade</span><span class="p">(</span><span class="n">s1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">s2</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Calcula similaridade usando distância de Levenshtein normalizada.&quot;&quot;&quot;</span>
            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">s2</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">):</span>
                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">0.0</span>
            
            <span class="c1"># Matriz de programação dinâmica para Levenshtein</span>
            <span class="n">matriz</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
            
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">matriz</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
            
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">custo</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">s2</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="mi">1</span>
                    <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                        <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>      <span class="c1"># Deleção</span>
                        <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>      <span class="c1"># Inserção</span>
                        <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">custo</span> <span class="c1"># Substituição</span>
                    <span class="p">)</span>
            
            <span class="n">distancia</span> <span class="o">=</span> <span class="n">matriz</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)][</span><span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">)]</span>
            <span class="n">max_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">))</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">distancia</span> <span class="o">/</span> <span class="n">max_len</span><span class="p">)</span>
        
        <span class="n">resultado</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">livro</span> <span class="ow">in</span> <span class="n">livros</span><span class="p">:</span>
            <span class="n">similaridade</span> <span class="o">=</span> <span class="n">calcular_similaridade</span><span class="p">(</span><span class="n">livro</span><span class="o">.</span><span class="n">titulo</span><span class="p">,</span> <span class="n">termo</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">similaridade</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span>
                <span class="n">resultado</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">livro</span><span class="p">)</span>
        
        <span class="c1"># Ordena por similaridade decrescente</span>
        <span class="n">resultado</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="n">calcular_similaridade</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">titulo</span><span class="p">,</span> <span class="n">termo</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resultado</span>

<span class="k">class</span><span class="w"> </span><span class="nc">BuscadorLivros</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CONTEXTO: Usa estratégias de busca intercambiáveis.</span>
<span class="sd">    BENEFÍCIO: Permite mudar algoritmo sem afetar código cliente.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">estrategia</span><span class="p">:</span> <span class="n">EstrategiaBusca</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Inicializa buscador com uma estratégia.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        estrategia : EstrategiaBusca</span>
<span class="sd">            Estratégia de busca a ser utilizada.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_estrategia</span> <span class="o">=</span> <span class="n">estrategia</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">set_estrategia</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">estrategia</span><span class="p">:</span> <span class="n">EstrategiaBusca</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Troca a estratégia de busca em tempo de execução.</span>
<span class="sd">        </span>
<span class="sd">        FLEXIBILIDADE: Permite adaptar o comportamento dinamicamente.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_estrategia</span> <span class="o">=</span> <span class="n">estrategia</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">buscar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livros</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Livro</span><span class="p">],</span> <span class="n">termo</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Livro</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Executa busca usando a estratégia atual.</span>
<span class="sd">        </span>
<span class="sd">        DELEGAÇÃO: Delega a implementação para a estratégia.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estrategia</span><span class="o">.</span><span class="n">buscar</span><span class="p">(</span><span class="n">livros</span><span class="p">,</span> <span class="n">termo</span><span class="p">)</span>

<span class="c1"># EXEMPLO DE USO:</span>
<span class="k">def</span><span class="w"> </span><span class="nf">exemplo_uso_strategy</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Demonstra o uso do padrão Strategy em ação.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">livros</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Livro</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Python Programming&quot;</span><span class="p">,</span> <span class="s2">&quot;John Doe&quot;</span><span class="p">,</span> <span class="s2">&quot;123456&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
        <span class="n">Livro</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Java Programming&quot;</span><span class="p">,</span> <span class="s2">&quot;Jane Smith&quot;</span><span class="p">,</span> <span class="s2">&quot;789012&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
        <span class="n">Livro</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Programming in Python&quot;</span><span class="p">,</span> <span class="s2">&quot;Bob Wilson&quot;</span><span class="p">,</span> <span class="s2">&quot;345678&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="p">]</span>
    
    <span class="c1"># Busca exata</span>
    <span class="n">buscador</span> <span class="o">=</span> <span class="n">BuscadorLivros</span><span class="p">(</span><span class="n">BuscaPorTitulo</span><span class="p">())</span>
    <span class="n">resultado_exato</span> <span class="o">=</span> <span class="n">buscador</span><span class="o">.</span><span class="n">buscar</span><span class="p">(</span><span class="n">livros</span><span class="p">,</span> <span class="s2">&quot;Python Programming&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Busca exata: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">resultado_exato</span><span class="p">)</span><span class="si">}</span><span class="s2"> resultado(s)&quot;</span><span class="p">)</span>
    
    <span class="c1"># Troca para busca similar</span>
    <span class="n">buscador</span><span class="o">.</span><span class="n">set_estrategia</span><span class="p">(</span><span class="n">BuscaPorTituloSimilar</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.6</span><span class="p">))</span>
    <span class="n">resultado_similar</span> <span class="o">=</span> <span class="n">buscador</span><span class="o">.</span><span class="n">buscar</span><span class="p">(</span><span class="n">livros</span><span class="p">,</span> <span class="s2">&quot;Python Programing&quot;</span><span class="p">)</span>  <span class="c1"># Erro de digitação</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Busca similar: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">resultado_similar</span><span class="p">)</span><span class="si">}</span><span class="s2"> resultado(s)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="implementacao-do-padrao-factory-method">
<h4><strong>Implementação do Padrão Factory Method</strong><a class="headerlink" href="#implementacao-do-padrao-factory-method" title="Link to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># PADRÃO: Factory Method</span>
<span class="c1"># PROBLEMA: Criação de diferentes tipos de usuários com regras específicas</span>
<span class="c1"># SOLUÇÃO: Fábrica que encapsula a lógica de criação</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>

<span class="k">class</span><span class="w"> </span><span class="nc">FabricaUsuario</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CLASSE ABSTRATA: Define interface para criação de usuários.</span>
<span class="sd">    BENEFÍCIO: Padroniza processo de criação independente do tipo.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">criar_usuario</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dados</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Usuario</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cria um usuário baseado nos dados fornecidos.&quot;&quot;&quot;</span>
        <span class="k">pass</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">validar_dados_basicos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dados</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Valida dados comuns a todos os tipos de usuário.</span>
<span class="sd">        </span>
<span class="sd">        REUTILIZAÇÃO: Lógica comum compartilhada entre subclasses.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">campos_obrigatorios</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nome&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">campo</span> <span class="ow">in</span> <span class="n">campos_obrigatorios</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">campo</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dados</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">dados</span><span class="p">[</span><span class="n">campo</span><span class="p">]:</span>
                <span class="k">return</span> <span class="kc">False</span>
        
        <span class="c1"># Validação básica de email</span>
        <span class="n">email</span> <span class="o">=</span> <span class="n">dados</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="s1">&#39;@&#39;</span> <span class="ow">in</span> <span class="n">email</span> <span class="ow">and</span> <span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">email</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="k">class</span><span class="w"> </span><span class="nc">FabricaLeitor</span><span class="p">(</span><span class="n">FabricaUsuario</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    FÁBRICA CONCRETA: Cria usuários do tipo leitor.</span>
<span class="sd">    ESPECIALIZAÇÃO: Regras específicas para leitores.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">criar_usuario</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dados</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Usuario</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cria um usuário leitor com validações específicas.</span>
<span class="sd">        </span>
<span class="sd">        REGRAS ESPECÍFICAS:</span>
<span class="sd">        - Verificação de idade mínima</span>
<span class="sd">        - Validação de documentos</span>
<span class="sd">        - Configuração de limites de empréstimo</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validar_dados_basicos</span><span class="p">(</span><span class="n">dados</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dados básicos inválidos para leitor&quot;</span><span class="p">)</span>
        
        <span class="c1"># Validações específicas para leitor</span>
        <span class="k">if</span> <span class="s1">&#39;idade&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dados</span> <span class="ow">or</span> <span class="n">dados</span><span class="p">[</span><span class="s1">&#39;idade&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Leitor deve ter pelo menos 16 anos&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="s1">&#39;documento&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dados</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Documento é obrigatório para leitores&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">Usuario</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="n">dados</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">nome</span><span class="o">=</span><span class="n">dados</span><span class="p">[</span><span class="s1">&#39;nome&#39;</span><span class="p">],</span>
            <span class="n">email</span><span class="o">=</span><span class="n">dados</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">],</span>
            <span class="n">tipo</span><span class="o">=</span><span class="s1">&#39;leitor&#39;</span>
        <span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">FabricaBibliotecario</span><span class="p">(</span><span class="n">FabricaUsuario</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    FÁBRICA CONCRETA: Cria usuários do tipo bibliotecário.</span>
<span class="sd">    ESPECIALIZAÇÃO: Regras específicas para bibliotecários.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">criar_usuario</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dados</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Usuario</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cria um usuário bibliotecário com validações específicas.</span>
<span class="sd">        </span>
<span class="sd">        REGRAS ESPECÍFICAS:</span>
<span class="sd">        - Verificação de credenciais profissionais</span>
<span class="sd">        - Validação de formação</span>
<span class="sd">        - Configuração de permissões administrativas</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validar_dados_basicos</span><span class="p">(</span><span class="n">dados</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dados básicos inválidos para bibliotecário&quot;</span><span class="p">)</span>
        
        <span class="c1"># Validações específicas para bibliotecário</span>
        <span class="k">if</span> <span class="s1">&#39;registro_profissional&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dados</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Registro profissional é obrigatório&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="s1">&#39;formacao&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dados</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Informação de formação é obrigatória&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">Usuario</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="n">dados</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">nome</span><span class="o">=</span><span class="n">dados</span><span class="p">[</span><span class="s1">&#39;nome&#39;</span><span class="p">],</span>
            <span class="n">email</span><span class="o">=</span><span class="n">dados</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">],</span>
            <span class="n">tipo</span><span class="o">=</span><span class="s1">&#39;bibliotecario&#39;</span>
        <span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">GerenciadorCriacaoUsuario</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CLIENTE: Usa as fábricas para criar usuários.</span>
<span class="sd">    BENEFÍCIO: Código cliente independente da lógica de criação.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># REGISTRY PATTERN: Mapeamento de tipos para fábricas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fabricas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">FabricaUsuario</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;leitor&#39;</span><span class="p">:</span> <span class="n">FabricaLeitor</span><span class="p">(),</span>
            <span class="s1">&#39;bibliotecario&#39;</span><span class="p">:</span> <span class="n">FabricaBibliotecario</span><span class="p">()</span>
        <span class="p">}</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">registrar_fabrica</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tipo</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fabrica</span><span class="p">:</span> <span class="n">FabricaUsuario</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Registra nova fábrica para um tipo de usuário.</span>
<span class="sd">        </span>
<span class="sd">        EXTENSIBILIDADE: Permite adicionar novos tipos sem modificar código.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fabricas</span><span class="p">[</span><span class="n">tipo</span><span class="p">]</span> <span class="o">=</span> <span class="n">fabrica</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">criar_usuario</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tipo</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dados</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Usuario</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cria usuário do tipo especificado usando a fábrica apropriada.</span>
<span class="sd">        </span>
<span class="sd">        POLIMORFISMO: Delega criação para fábrica específica.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tipo</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fabricas</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tipo de usuário &#39;</span><span class="si">{</span><span class="n">tipo</span><span class="si">}</span><span class="s2">&#39; não suportado&quot;</span><span class="p">)</span>
        
        <span class="n">fabrica</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fabricas</span><span class="p">[</span><span class="n">tipo</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">fabrica</span><span class="o">.</span><span class="n">criar_usuario</span><span class="p">(</span><span class="n">dados</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="implementacao-do-padrao-observer">
<h4><strong>Implementação do Padrão Observer</strong><a class="headerlink" href="#implementacao-do-padrao-observer" title="Link to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># PADRÃO: Observer</span>
<span class="c1"># PROBLEMA: Notificar múltiplos interessados sobre mudanças de estado</span>
<span class="c1"># SOLUÇÃO: Sistema de notificação desacoplado</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Protocol</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ObservadorEmprestimo</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    INTERFACE: Define contrato para observadores de empréstimos.</span>
<span class="sd">    BENEFÍCIO: Desacopla quem notifica de quem é notificado.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">notificar_emprestimo_realizado</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Notifica que um empréstimo foi realizado.&quot;&quot;&quot;</span>
        <span class="o">...</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">notificar_devolucao_realizada</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Notifica que uma devolução foi realizada.&quot;&quot;&quot;</span>
        <span class="o">...</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">notificar_multa_aplicada</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">,</span> <span class="n">valor</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Notifica que uma multa foi aplicada.&quot;&quot;&quot;</span>
        <span class="o">...</span>

<span class="k">class</span><span class="w"> </span><span class="nc">NotificadorEmail</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    OBSERVADOR CONCRETO: Envia notificações por email.</span>
<span class="sd">    RESPONSABILIDADE: Gerenciar comunicação via email.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">servico_email</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">servico_email</span> <span class="o">=</span> <span class="n">servico_email</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">notificar_emprestimo_realizado</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Envia email de confirmação de empréstimo.</span>
<span class="sd">        </span>
<span class="sd">        ESPECIALIZAÇÃO: Formatação específica para email.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">assunto</span> <span class="o">=</span> <span class="s2">&quot;Confirmação de Empréstimo&quot;</span>
        <span class="n">mensagem</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Olá,</span>
<span class="s2">        </span>
<span class="s2">        Seu empréstimo foi realizado com sucesso!</span>
<span class="s2">        Data de devolução: </span><span class="si">{</span><span class="n">emprestimo</span><span class="o">.</span><span class="n">data_devolucao</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        </span>
<span class="s2">        Atenciosamente,</span>
<span class="s2">        Sistema Biblioteca</span>
<span class="s2">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Simulação de envio de email</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📧 Email enviado: </span><span class="si">{</span><span class="n">assunto</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mensagem: </span><span class="si">{</span><span class="n">mensagem</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">notificar_devolucao_realizada</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Envia email de confirmação de devolução.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📧 Email: Devolução confirmada para empréstimo </span><span class="si">{</span><span class="n">emprestimo</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">notificar_multa_aplicada</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">,</span> <span class="n">valor</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Envia email sobre multa aplicada.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📧 Email: Multa de R$ </span><span class="si">{</span><span class="n">valor</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> aplicada ao empréstimo </span><span class="si">{</span><span class="n">emprestimo</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">LoggerSistema</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    OBSERVADOR CONCRETO: Registra eventos no log do sistema.</span>
<span class="sd">    RESPONSABILIDADE: Auditoria e rastreamento.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">notificar_emprestimo_realizado</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Registra empréstimo no log.&quot;&quot;&quot;</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📝 LOG [</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">]: Empréstimo </span><span class="si">{</span><span class="n">emprestimo</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> realizado&quot;</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">notificar_devolucao_realizada</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Registra devolução no log.&quot;&quot;&quot;</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📝 LOG [</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">]: Devolução do empréstimo </span><span class="si">{</span><span class="n">emprestimo</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">notificar_multa_aplicada</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">,</span> <span class="n">valor</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Registra multa no log.&quot;&quot;&quot;</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📝 LOG [</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">]: Multa R$ </span><span class="si">{</span><span class="n">valor</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> - Empréstimo </span><span class="si">{</span><span class="n">emprestimo</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">GerenciadorEmprestimos</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SUBJECT: Gerencia empréstimos e notifica observadores.</span>
<span class="sd">    BENEFÍCIO: Funcionalidade core isolada da lógica de notificação.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_observadores</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ObservadorEmprestimo</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_emprestimos</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Emprestimo</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_proximo_id</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">adicionar_observador</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observador</span><span class="p">:</span> <span class="n">ObservadorEmprestimo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adiciona um observador à lista de notificação.</span>
<span class="sd">        </span>
<span class="sd">        FLEXIBILIDADE: Permite adicionar/remover observadores dinamicamente.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_observadores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">observador</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">remover_observador</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observador</span><span class="p">:</span> <span class="n">ObservadorEmprestimo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove um observador da lista de notificação.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">observador</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observadores</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_observadores</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">observador</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_notificar_emprestimo_realizado</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Notifica todos os observadores sobre empréstimo realizado.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">observador</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observadores</span><span class="p">:</span>
            <span class="n">observador</span><span class="o">.</span><span class="n">notificar_emprestimo_realizado</span><span class="p">(</span><span class="n">emprestimo</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_notificar_devolucao_realizada</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Notifica todos os observadores sobre devolução realizada.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">observador</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observadores</span><span class="p">:</span>
            <span class="n">observador</span><span class="o">.</span><span class="n">notificar_devolucao_realizada</span><span class="p">(</span><span class="n">emprestimo</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_notificar_multa_aplicada</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">,</span> <span class="n">valor</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Notifica todos os observadores sobre multa aplicada.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">observador</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observadores</span><span class="p">:</span>
            <span class="n">observador</span><span class="o">.</span><span class="n">notificar_multa_aplicada</span><span class="p">(</span><span class="n">emprestimo</span><span class="p">,</span> <span class="n">valor</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">realizar_emprestimo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livro_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">usuario_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Emprestimo</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Realiza um empréstimo e notifica observadores.</span>
<span class="sd">        </span>
<span class="sd">        SEPARAÇÃO DE RESPONSABILIDADES: Lógica de negócio + notificação.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_emprestimo</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">data_devolucao</span> <span class="o">=</span> <span class="n">data_emprestimo</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        
        <span class="n">emprestimo</span> <span class="o">=</span> <span class="n">Emprestimo</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_proximo_id</span><span class="p">,</span>
            <span class="n">livro_id</span><span class="o">=</span><span class="n">livro_id</span><span class="p">,</span>
            <span class="n">usuario_id</span><span class="o">=</span><span class="n">usuario_id</span><span class="p">,</span>
            <span class="n">data_emprestimo</span><span class="o">=</span><span class="n">data_emprestimo</span><span class="p">,</span>
            <span class="n">data_devolucao</span><span class="o">=</span><span class="n">data_devolucao</span><span class="p">,</span>
            <span class="n">devolvido</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_proximo_id</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_emprestimos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">emprestimo</span><span class="p">)</span>
        
        <span class="c1"># Notifica observadores</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_notificar_emprestimo_realizado</span><span class="p">(</span><span class="n">emprestimo</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">emprestimo</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">realizar_devolucao</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Realiza devolução e notifica observadores.&quot;&quot;&quot;</span>
        <span class="n">emprestimo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buscar_emprestimo</span><span class="p">(</span><span class="n">emprestimo_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">emprestimo</span> <span class="ow">or</span> <span class="n">emprestimo</span><span class="o">.</span><span class="n">devolvido</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="n">emprestimo</span><span class="o">.</span><span class="n">marcar_devolvido</span><span class="p">()</span>
        
        <span class="c1"># Notifica observadores</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_notificar_devolucao_realizada</span><span class="p">(</span><span class="n">emprestimo</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="kc">True</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_buscar_emprestimo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Emprestimo</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Busca empréstimo por ID.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">emp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_emprestimos</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">emp</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">emprestimo_id</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">emp</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="c1"># EXEMPLO DE USO:</span>
<span class="k">def</span><span class="w"> </span><span class="nf">exemplo_uso_observer</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Demonstra o uso do padrão Observer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Criação do gerenciador</span>
    <span class="n">gerenciador</span> <span class="o">=</span> <span class="n">GerenciadorEmprestimos</span><span class="p">()</span>
    
    <span class="c1"># Criação dos observadores</span>
    <span class="n">notificador_email</span> <span class="o">=</span> <span class="n">NotificadorEmail</span><span class="p">(</span><span class="n">servico_email</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">LoggerSistema</span><span class="p">()</span>
    
    <span class="c1"># Registro dos observadores</span>
    <span class="n">gerenciador</span><span class="o">.</span><span class="n">adicionar_observador</span><span class="p">(</span><span class="n">notificador_email</span><span class="p">)</span>
    <span class="n">gerenciador</span><span class="o">.</span><span class="n">adicionar_observador</span><span class="p">(</span><span class="n">logger</span><span class="p">)</span>
    
    <span class="c1"># Realização de empréstimo (dispara notificações)</span>
    <span class="n">emprestimo</span> <span class="o">=</span> <span class="n">gerenciador</span><span class="o">.</span><span class="n">realizar_emprestimo</span><span class="p">(</span><span class="n">livro_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">usuario_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="c1"># Realização de devolução (dispara notificações)</span>
    <span class="n">gerenciador</span><span class="o">.</span><span class="n">realizar_devolucao</span><span class="p">(</span><span class="n">emprestimo</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="ferramentas-bibliotecas-e-ecossistema-contextual">
<h3><strong>3.3. Ferramentas, Bibliotecas e Ecossistema (Contextual)</strong><a class="headerlink" href="#ferramentas-bibliotecas-e-ecossistema-contextual" title="Link to this heading">#</a></h3>
<p>Para a demonstração dos conceitos avançados de Programação Orientada a Objetos apresentados nesta aula, <strong>utilizamos exclusivamente recursos nativos do Python 3.12+</strong>. Nenhuma biblioteca externa foi necessária, reforçando que os princípios SOLID, padrões de design e boas práticas de POO são fundamentais à estruturação do código e não dependem de ferramentas de terceiros.</p>
<section id="recursos-nativos-utilizados">
<h4><strong>Recursos Nativos Utilizados</strong><a class="headerlink" href="#recursos-nativos-utilizados" title="Link to this heading">#</a></h4>
<p><strong>Módulo <code class="docutils literal notranslate"><span class="pre">typing</span></code> (Python 3.5+):</strong></p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">List[T]</span></code></strong>: Type hints para listas tipadas</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Optional[T]</span></code></strong>: Representação de valores opcionais (Union[T, None])</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Dict[K,</span> <span class="pre">V]</span></code></strong>: Type hints para dicionários tipados</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Any</span></code></strong>: Type hint para qualquer tipo (usado com moderação)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Protocol</span></code></strong>: Definição de interfaces estruturais (Python 3.8+)</p></li>
</ul>
<p><strong>Justificativa</strong>: O módulo <code class="docutils literal notranslate"><span class="pre">typing</span></code> foi essencial para demonstrar contratos claros entre classes, especialmente na implementação do padrão Strategy com <code class="docutils literal notranslate"><span class="pre">Protocol</span></code>, tornando o código mais legível e permitindo verificação estática de tipos.</p>
<p><strong>Módulo <code class="docutils literal notranslate"><span class="pre">datetime</span></code> (Python Padrão):</strong></p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">datetime.now()</span></code></strong>: Obtenção de timestamp atual</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">datetime.strftime()</span></code></strong>: Formatação de datas para display</p></li>
<li><p><strong>Operações aritméticas</strong>: Cálculo de diferenças entre datas</p></li>
</ul>
<p><strong>Justificativa</strong>: Utilizado no sistema de biblioteca para gerenciar datas de empréstimo e devolução, demonstrando como objetos de domínio lidam com dados temporais de forma natural.</p>
<p><strong>Módulo <code class="docutils literal notranslate"><span class="pre">dataclasses</span></code> (Python 3.7+):</strong></p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code></strong>: Geração automática de métodos especiais</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">field()</span></code></strong>: Configuração avançada de atributos</p></li>
</ul>
<p><strong>Justificativa</strong>: Demonstrou como reduzir boilerplate mantendo princípios de POO, especialmente útil para objetos de valor e entidades de domínio.</p>
<p><strong>Módulo <code class="docutils literal notranslate"><span class="pre">abc</span></code> (Abstract Base Classes):</strong></p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">ABC</span></code></strong>: Classe base para classes abstratas</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">&#64;abstractmethod</span></code></strong>: Decorador para métodos abstratos</p></li>
</ul>
<p><strong>Justificativa</strong>: Fundamental para demonstrar o Princípio da Inversão de Dependência (DIP) e padrões como Strategy e Factory Method, garantindo contratos explícitos entre classes.</p>
<p><strong>Módulo <code class="docutils literal notranslate"><span class="pre">weakref</span></code> (Python Padrão):</strong></p>
<ul class="simple">
<li><p><strong>Referências fracas</strong>: Prevenção de vazamentos de memória no padrão Observer</p></li>
</ul>
<p><strong>Justificativa</strong>: Demonstrou técnica avançada de gerenciamento de memória essencial em sistemas com notificações, evitando referências circulares.</p>
</section>
<section id="por-que-apenas-python-nativo">
<h4><strong>Por Que Apenas Python Nativo?</strong><a class="headerlink" href="#por-que-apenas-python-nativo" title="Link to this heading">#</a></h4>
<p><strong>Fundamentos São Universais:</strong>
Os princípios SOLID, padrões GoF e boas práticas de POO são conceitos fundamentais que transcendem linguagens e frameworks. Ao usar apenas Python nativo, demonstramos que estes conceitos são intrínsecos à programação orientada a objetos, não dependendo de bibliotecas específicas.</p>
<p><strong>Transferibilidade:</strong>
Código escrito com recursos nativos é mais facilmente compreendido e adaptado para diferentes contextos, seja em projetos corporativos, acadêmicos ou open source.</p>
<p><strong>Foco no Aprendizado:</strong>
Eliminar dependências externas mantém o foco nos conceitos centrais, sem distrações causadas por sintaxes específicas de frameworks.</p>
</section>
<section id="ambiente-de-desenvolvimento-recomendado">
<h4><strong>Ambiente de Desenvolvimento Recomendado</strong><a class="headerlink" href="#ambiente-de-desenvolvimento-recomendado" title="Link to this heading">#</a></h4>
<p><strong>Versão Python:</strong></p>
<ul class="simple">
<li><p><strong>Python 3.12+</strong> para aproveitar as melhorias mais recentes em type hints e performance</p></li>
</ul>
<p><strong>IDE/Editor:</strong></p>
<ul class="simple">
<li><p><strong>VS Code</strong> com extensão Python para highlighting de type hints</p></li>
<li><p><strong>PyCharm</strong> para refatoração avançada e análise estática</p></li>
<li><p>Qualquer editor que suporte Python com syntax highlighting</p></li>
</ul>
<p><strong>Verificação de Tipos (Opcional):</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Para validar type hints (não obrigatório para execução)</span>
pip<span class="w"> </span>install<span class="w"> </span>mypy
mypy<span class="w"> </span>nome_do_arquivo.py
</pre></div>
</div>
<blockquote>
<div><p><strong>💡 Insight Pedagógico</strong>: A ausência de dependências externas nesta aula reforça que dominar POO significa dominar princípios fundamentais de design de software. Frameworks e bibliotecas são ferramentas; POO é a base sobre a qual essas ferramentas são construídas.</p>
</div></blockquote>
<p><strong>Vantagens da Implementação Pura:</strong></p>
<ul class="simple">
<li><p><strong>Zero dependências:</strong> Funciona em qualquer ambiente Python</p></li>
<li><p><strong>Controle total:</strong> Você entende exatamente como funciona</p></li>
<li><p><strong>Performance otimizada:</strong> Sem overhead de bibliotecas genéricas</p></li>
<li><p><strong>Aprendizado profundo:</strong> Força compreensão dos conceitos fundamentais</p></li>
</ul>
<p><strong>Quando usar implementação pura vs bibliotecas:</strong></p>
<ul class="simple">
<li><p><strong>Use puro:</strong> Ambientes embarcados, sistemas críticos, fins educacionais</p></li>
<li><p><strong>Use bibliotecas:</strong> Desenvolvimento rápido, padrões complexos, equipes grandes</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section id="topicos-avancados-e-nuances">
<h2>4. Tópicos Avançados e Nuances<a class="headerlink" href="#topicos-avancados-e-nuances" title="Link to this heading">#</a></h2>
<section id="desafios-comuns-e-anti-padroes">
<h3>4.1. Desafios Comuns e “Anti-Padrões”<a class="headerlink" href="#desafios-comuns-e-anti-padroes" title="Link to this heading">#</a></h3>
<section id="god-object-objeto-deus">
<h4><strong>God Object (Objeto Deus)</strong><a class="headerlink" href="#god-object-objeto-deus" title="Link to this heading">#</a></h4>
<p><strong>Definição:</strong> Uma classe que concentra responsabilidades demais, tornando o sistema difícil de manter e evoluir.</p>
<p><strong>Sintomas:</strong></p>
<ul class="simple">
<li><p>Classes com mais de 1000 linhas de código</p></li>
<li><p>Mais de 20 métodos públicos</p></li>
<li><p>Dependências com muitas outras classes</p></li>
<li><p>Dificulta testes unitários</p></li>
</ul>
<p><strong>Exemplo Problemático:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">SistemaBiblioteca</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ANTI-PADRÃO: God Object</span>
<span class="sd">    PROBLEMA: Uma classe fazendo absolutamente tudo.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">livros</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">usuarios</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emprestimos</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">configuracoes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># ... dezenas de outros atributos</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">cadastrar_livro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dados</span><span class="p">):</span> <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">buscar_livro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">termo</span><span class="p">):</span> <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">emprestar_livro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livro_id</span><span class="p">,</span> <span class="n">usuario_id</span><span class="p">):</span> <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">calcular_multa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo_id</span><span class="p">):</span> <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">gerar_relatorio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tipo</span><span class="p">):</span> <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">enviar_email</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">destinatario</span><span class="p">,</span> <span class="n">assunto</span><span class="p">):</span> <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">backup_dados</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validar_isbn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isbn</span><span class="p">):</span> <span class="k">pass</span>
    <span class="c1"># ... centenas de outros métodos</span>
</pre></div>
</div>
<p><strong>Solução:</strong> Aplicar SRP, extrair responsabilidades para classes especializadas:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GerenciadorLivros</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GerenciadorUsuarios</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GerenciadorEmprestimos</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CalculadoraMulta</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GeradorRelatorio</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ServicoEmail</span></code></p></li>
</ul>
</section>
<section id="spaghetti-code-codigo-espaguete">
<h4><strong>Spaghetti Code (Código Espaguete)</strong><a class="headerlink" href="#spaghetti-code-codigo-espaguete" title="Link to this heading">#</a></h4>
<p><strong>Definição:</strong> Código sem estrutura clara, com fluxo de controle confuso e dependências implícitas.</p>
<p><strong>Sintomas:</strong></p>
<ul class="simple">
<li><p>Uso excessivo de variáveis globais</p></li>
<li><p>Funções muito longas (&gt;50 linhas)</p></li>
<li><p>Lógica condicional profundamente aninhada</p></li>
<li><p>Falta de modularização</p></li>
</ul>
<p><strong>Exemplo Problemático:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ANTI-PADRÃO: Spaghetti Code</span>
<span class="n">livros_globais</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">usuarios_globais</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">configuracao_global</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">def</span><span class="w"> </span><span class="nf">processar_emprestimo</span><span class="p">(</span><span class="n">livro_titulo</span><span class="p">,</span> <span class="n">usuario_nome</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">livros_globais</span><span class="p">,</span> <span class="n">usuarios_globais</span><span class="p">,</span> <span class="n">configuracao_global</span>
    
    <span class="c1"># Lógica complexa e aninhada</span>
    <span class="k">for</span> <span class="n">livro</span> <span class="ow">in</span> <span class="n">livros_globais</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">livro</span><span class="p">[</span><span class="s1">&#39;titulo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">livro_titulo</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">livro</span><span class="p">[</span><span class="s1">&#39;disponivel&#39;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">usuario</span> <span class="ow">in</span> <span class="n">usuarios_globais</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">usuario</span><span class="p">[</span><span class="s1">&#39;nome&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">usuario_nome</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">usuario</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bloqueado&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">usuario</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;emprestimos&#39;</span><span class="p">,</span> <span class="p">[]))</span> <span class="o">&lt;</span> <span class="n">configuracao_global</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;max_emprestimos&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
                                <span class="c1"># ... mais aninhamento ...</span>
                                <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
<p><strong>Solução:</strong></p>
<ul class="simple">
<li><p>Encapsular dados em classes</p></li>
<li><p>Extrair funções pequenas e coesas</p></li>
<li><p>Eliminar variáveis globais</p></li>
<li><p>Usar early returns para reduzir aninhamento</p></li>
</ul>
</section>
<section id="shotgun-surgery-cirurgia-com-espingarda">
<h4><strong>Shotgun Surgery (Cirurgia com Espingarda)</strong><a class="headerlink" href="#shotgun-surgery-cirurgia-com-espingarda" title="Link to this heading">#</a></h4>
<p><strong>Definição:</strong> Mudanças pequenas exigem alterações em múltiplos pontos do sistema.</p>
<p><strong>Sintomas:</strong></p>
<ul class="simple">
<li><p>Duplicação de lógica de negócio</p></li>
<li><p>Falta de centralização de regras</p></li>
<li><p>Alto acoplamento entre módulos</p></li>
</ul>
<p><strong>Exemplo Problemático:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># PROBLEMA: Regra de multa duplicada em vários lugares</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Emprestimo</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">calcular_multa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">dias_atraso</span> <span class="o">=</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_devolucao</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dias_atraso</span> <span class="o">*</span> <span class="mf">2.0</span><span class="p">)</span>  <span class="c1"># R$ 2,00 por dia</span>

<span class="k">class</span><span class="w"> </span><span class="nc">RelatorioMultas</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">calcular_total_multas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimos</span><span class="p">):</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">emp</span> <span class="ow">in</span> <span class="n">emprestimos</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">emp</span><span class="o">.</span><span class="n">devolvido</span><span class="p">:</span>
                <span class="n">dias_atraso</span> <span class="o">=</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">emp</span><span class="o">.</span><span class="n">data_devolucao</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>
                <span class="n">multa</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dias_atraso</span> <span class="o">*</span> <span class="mf">2.0</span><span class="p">)</span>  <span class="c1"># DUPLICAÇÃO!</span>
                <span class="n">total</span> <span class="o">+=</span> <span class="n">multa</span>
        <span class="k">return</span> <span class="n">total</span>

<span class="k">class</span><span class="w"> </span><span class="nc">NotificadorMultas</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">verificar_multas_pendentes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimos</span><span class="p">):</span>
        <span class="n">emprestimos_com_multa</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">emp</span> <span class="ow">in</span> <span class="n">emprestimos</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">emp</span><span class="o">.</span><span class="n">devolvido</span><span class="p">:</span>
                <span class="n">dias_atraso</span> <span class="o">=</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">emp</span><span class="o">.</span><span class="n">data_devolucao</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>
                <span class="k">if</span> <span class="n">dias_atraso</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">multa</span> <span class="o">=</span> <span class="n">dias_atraso</span> <span class="o">*</span> <span class="mf">2.0</span>  <span class="c1"># DUPLICAÇÃO NOVAMENTE!</span>
                    <span class="n">emprestimos_com_multa</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">emp</span><span class="p">,</span> <span class="n">multa</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">emprestimos_com_multa</span>
</pre></div>
</div>
<p><strong>Solução:</strong> Centralizar regras em uma única classe responsável:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CalculadoraMulta</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valor_por_dia</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valor_por_dia</span> <span class="o">=</span> <span class="n">valor_por_dia</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">calcular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">emprestimo</span><span class="o">.</span><span class="n">devolvido</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        
        <span class="n">dias_atraso</span> <span class="o">=</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">emprestimo</span><span class="o">.</span><span class="n">data_devolucao</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dias_atraso</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">valor_por_dia</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p><strong>🚨 Caixa de Destaque: Armadilhas a Evitar</strong></p>
<ol class="arabic simple">
<li><p><strong>Otimização Prematura:</strong> Evite otimizar código antes de medir performance. “A raiz de todo mal na programação é a otimização prematura” - Donald Knuth. Profile primeiro, otimize depois.</p></li>
<li><p><strong>Abstração Prematura:</strong> Não crie abstrações “por precaução”. Espere ter pelo menos 2-3 casos de uso concretos antes de abstrair. Abstrações erradas são piores que duplicação temporária.</p></li>
<li><p><strong>Pattern Fever:</strong> Não force padrões onde eles não se aplicam. Uma simples função pode ser melhor que um padrão complexo. Use padrões quando o problema que eles resolvem está claramente presente.</p></li>
<li><p><strong>Copy-Paste Programming:</strong> Resistir à tentação de copiar código “porque funciona”. Duplicação aparentemente simples hoje vira pesadelo de manutenção amanhã. Invista tempo em abstrair corretamente.</p></li>
</ol>
</div></blockquote>
</section>
</section>
<section id="variacoes-e-arquiteturas-especializadas">
<h3>4.2. Variações e Arquiteturas Especializadas<a class="headerlink" href="#variacoes-e-arquiteturas-especializadas" title="Link to this heading">#</a></h3>
<section id="arquitetura-hexagonal-ports-and-adapters">
<h4><strong>Arquitetura Hexagonal (Ports and Adapters)</strong><a class="headerlink" href="#arquitetura-hexagonal-ports-and-adapters" title="Link to this heading">#</a></h4>
<p><strong>Conceito Avançado:</strong> A Arquitetura Hexagonal, proposta por Alistair Cockburn, vai além da POO tradicional ao isolar completamente a lógica de negócio de detalhes de implementação através de <strong>portas</strong> (interfaces) e <strong>adaptadores</strong> (implementações concretas).</p>
<p><strong>Vantagens sobre OOP tradicional:</strong></p>
<ul class="simple">
<li><p><strong>Testabilidade Superior:</strong> Mock completo de dependências externas sem afetar a lógica central</p></li>
<li><p><strong>Independência de Tecnologia:</strong> Mudança de banco de dados, APIs ou frameworks sem reescrita</p></li>
<li><p><strong>Isolamento de Domínio:</strong> Regras de negócio puras, sem contaminação por detalhes técnicos</p></li>
<li><p><strong>Flexibilidade de Deploy:</strong> Mesmo core pode ser exposto via Web, CLI, ou API</p></li>
</ul>
<p><strong>Estrutura Arquitetural:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[Interface Web] ← [Adaptador Web] ← [Porta HTTP]
                                        ↑
[Core de Negócio] ← [Porta Repository] → [Adaptador PostgreSQL] → [PostgreSQL]
                  ← [Porta Notification] → [Adaptador Email] → [SMTP Server]
                                        ↓
[Interface CLI] ← [Adaptador CLI] ← [Porta CLI]
</pre></div>
</div>
<p><strong>Implementação Prática:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># PORTA: Interface que define o contrato</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RepositorioLivrosPort</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">salvar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livro</span><span class="p">:</span> <span class="n">Livro</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">buscar_por_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Livro</span><span class="p">]:</span> <span class="o">...</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">listar_todos</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Livro</span><span class="p">]:</span> <span class="o">...</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">buscar_por_autor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">autor</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Livro</span><span class="p">]:</span> <span class="o">...</span>

<span class="c1"># NÚCLEO: Lógica de negócio pura, sem dependências externas</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ServicoGestaoLivros</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NÚCLEO DE NEGÓCIO: Regras puras sem conhecimento de infraestrutura.</span>
<span class="sd">    Depende apenas de abstrações (portas), nunca de implementações.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">repositorio</span><span class="p">:</span> <span class="n">RepositorioLivrosPort</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_repositorio</span> <span class="o">=</span> <span class="n">repositorio</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">cadastrar_livro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">titulo</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">autor</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">isbn</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Livro</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        REGRA DE NEGÓCIO: ISBN deve ser único no sistema.</span>
<span class="sd">        Não sabe se é PostgreSQL, MongoDB ou arquivo - depende apenas da porta.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validação de regra de negócio</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isbn_valido</span><span class="p">(</span><span class="n">isbn</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ISBN inválido&quot;</span><span class="p">)</span>
        
        <span class="c1"># Verificação de unicidade</span>
        <span class="n">livros_existentes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repositorio</span><span class="o">.</span><span class="n">listar_todos</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">livro</span><span class="o">.</span><span class="n">isbn</span> <span class="o">==</span> <span class="n">isbn</span> <span class="k">for</span> <span class="n">livro</span> <span class="ow">in</span> <span class="n">livros_existentes</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ISBN já cadastrado&quot;</span><span class="p">)</span>
        
        <span class="c1"># Criação conforme regras de domínio</span>
        <span class="n">livro</span> <span class="o">=</span> <span class="n">Livro</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_gerar_proximo_id</span><span class="p">(),</span>
            <span class="n">titulo</span><span class="o">=</span><span class="n">titulo</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span>
            <span class="n">autor</span><span class="o">=</span><span class="n">autor</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span>
            <span class="n">isbn</span><span class="o">=</span><span class="n">isbn</span><span class="p">,</span>
            <span class="n">disponivel</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_repositorio</span><span class="o">.</span><span class="n">salvar</span><span class="p">(</span><span class="n">livro</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">livro</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_isbn_valido</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isbn</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validação de formato ISBN-13&quot;&quot;&quot;</span>
        <span class="n">isbn_digitos</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">isdigit</span><span class="p">,</span> <span class="n">isbn</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">isbn_digitos</span><span class="p">)</span> <span class="o">==</span> <span class="mi">13</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checksum_isbn13</span><span class="p">(</span><span class="n">isbn_digitos</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_checksum_isbn13</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isbn</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Algoritmo de validação ISBN-13&quot;&quot;&quot;</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">digit</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">3</span><span class="p">)</span> 
                   <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">digit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">isbn</span><span class="p">[:</span><span class="mi">12</span><span class="p">]))</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">10</span> <span class="o">-</span> <span class="p">(</span><span class="n">total</span> <span class="o">%</span> <span class="mi">10</span><span class="p">))</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">isbn</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>

<span class="c1"># ADAPTADOR: Implementação específica para PostgreSQL</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RepositorioLivrosPostgreSQL</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ADAPTADOR CONCRETO: Traduz chamadas da porta para SQL específico.</span>
<span class="sd">    Conhece detalhes de PostgreSQL, mas núcleo não sabe disso.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connection_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">connection_string</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">salvar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livro</span><span class="p">:</span> <span class="n">Livro</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            INSERT INTO livros (id, titulo, autor, isbn, disponivel)</span>
<span class="s2">            VALUES (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)</span>
<span class="s2">            ON CONFLICT (id) DO UPDATE SET</span>
<span class="s2">                titulo = EXCLUDED.titulo,</span>
<span class="s2">                autor = EXCLUDED.autor,</span>
<span class="s2">                isbn = EXCLUDED.isbn,</span>
<span class="s2">                disponivel = EXCLUDED.disponivel</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">livro</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">livro</span><span class="o">.</span><span class="n">titulo</span><span class="p">,</span> <span class="n">livro</span><span class="o">.</span><span class="n">autor</span><span class="p">,</span> <span class="n">livro</span><span class="o">.</span><span class="n">isbn</span><span class="p">,</span> <span class="n">livro</span><span class="o">.</span><span class="n">disponivel</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">buscar_por_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Livro</span><span class="p">]:</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM livros WHERE id = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nb">id</span><span class="p">,))</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_to_livro</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">if</span> <span class="n">row</span> <span class="k">else</span> <span class="kc">None</span>

<span class="c1"># ADAPTADOR ALTERNATIVO: Implementação para DuckDB (análises)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RepositorioLivrosDuckDB</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ADAPTADOR ALTERNATIVO: Mesmo contrato, implementação diferente.</span>
<span class="sd">    Núcleo de negócio funciona identicamente.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_criar_tabelas</span><span class="p">()</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">salvar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livro</span><span class="p">:</span> <span class="n">Livro</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            INSERT OR REPLACE INTO livros </span>
<span class="s2">            VALUES (?, ?, ?, ?, ?)</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">livro</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">livro</span><span class="o">.</span><span class="n">titulo</span><span class="p">,</span> <span class="n">livro</span><span class="o">.</span><span class="n">autor</span><span class="p">,</span> <span class="n">livro</span><span class="o">.</span><span class="n">isbn</span><span class="p">,</span> <span class="n">livro</span><span class="o">.</span><span class="n">disponivel</span><span class="p">))</span>

<span class="c1"># COMPOSIÇÃO: Wiring das dependências</span>
<span class="k">def</span><span class="w"> </span><span class="nf">criar_servico_livros</span><span class="p">(</span><span class="n">tipo_repositorio</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServicoGestaoLivros</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    FACTORY: Cria serviço com repositório apropriado.</span>
<span class="sd">    Demonstra como a arquitetura hexagonal facilita configuração.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">tipo_repositorio</span> <span class="o">==</span> <span class="s2">&quot;postgresql&quot;</span><span class="p">:</span>
        <span class="n">repo</span> <span class="o">=</span> <span class="n">RepositorioLivrosPostgreSQL</span><span class="p">(</span><span class="s2">&quot;postgresql://localhost/biblioteca&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">tipo_repositorio</span> <span class="o">==</span> <span class="s2">&quot;duckdb&quot;</span><span class="p">:</span>
        <span class="n">repo</span> <span class="o">=</span> <span class="n">RepositorioLivrosDuckDB</span><span class="p">(</span><span class="s2">&quot;biblioteca.duckdb&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">tipo_repositorio</span> <span class="o">==</span> <span class="s2">&quot;memoria&quot;</span><span class="p">:</span>
        <span class="n">repo</span> <span class="o">=</span> <span class="n">RepositorioLivrosMemoria</span><span class="p">()</span>  <span class="c1"># Para testes</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tipo de repositório não suportado: </span><span class="si">{</span><span class="n">tipo_repositorio</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ServicoGestaoLivros</span><span class="p">(</span><span class="n">repo</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="domain-driven-design-ddd-com-poo">
<h4><strong>Domain-Driven Design (DDD) com POO</strong><a class="headerlink" href="#domain-driven-design-ddd-com-poo" title="Link to this heading">#</a></h4>
<p><strong>Conceito Avançado:</strong> DDD transcende padrões individuais ao estruturar todo o sistema em torno do <strong>domínio de negócio</strong>, usando POO como ferramenta para expressar conceitos do mundo real.</p>
<p><strong>Elementos Fundamentais:</strong></p>
<ul class="simple">
<li><p><strong>Entities:</strong> Objetos com identidade única e ciclo de vida</p></li>
<li><p><strong>Value Objects:</strong> Objetos imutáveis definidos pelos seus atributos</p></li>
<li><p><strong>Aggregates:</strong> Clusters de entidades com consistência transacional</p></li>
<li><p><strong>Domain Services:</strong> Operações que não pertencem naturalmente a uma entidade</p></li>
<li><p><strong>Repositories:</strong> Abstração para persistência de aggregates</p></li>
</ul>
<p><strong>Implementação DDD:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># VALUE OBJECT: ISBN como conceito de domínio</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ISBN</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    VALUE OBJECT: Encapsula regras de validação e comportamentos do ISBN.</span>
<span class="sd">    Imutável, comparado por valor, não por identidade.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_valid</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ISBN inválido: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">digits</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">isdigit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span> <span class="o">==</span> <span class="mi">13</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checksum_valid</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retorna ISBN formatado: 978-3-16-148410-0&quot;&quot;&quot;</span>
        <span class="n">digits</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">isdigit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">digits</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">digits</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">digits</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">digits</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">digits</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># ENTITY: Livro como entidade de domínio</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Livro</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ENTITY: Tem identidade única e estados que mudam ao longo do tempo.</span>
<span class="sd">    Encapsula regras de negócio relacionadas a empréstimos.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">titulo</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">autor</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">isbn</span><span class="p">:</span> <span class="n">ISBN</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_id</span> <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_titulo</span> <span class="o">=</span> <span class="n">titulo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_autor</span> <span class="o">=</span> <span class="n">autor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_isbn</span> <span class="o">=</span> <span class="n">isbn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_disponivel</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_emprestimos</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Emprestimo</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">pode_ser_emprestado</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;REGRA DE DOMÍNIO: Livro disponível e sem empréstimos pendentes&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disponivel</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tem_emprestimo_ativo</span><span class="p">()</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">emprestar_para</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">usuario</span><span class="p">:</span> <span class="n">Usuario</span><span class="p">,</span> <span class="n">data_devolucao</span><span class="p">:</span> <span class="n">datetime</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Emprestimo</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        OPERAÇÃO DE DOMÍNIO: Empresta livro seguindo regras de negócio.</span>
<span class="sd">        Raises ValueError se empréstimo não for possível.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pode_ser_emprestado</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Livro não pode ser emprestado no momento&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">data_devolucao</span> <span class="o">&lt;=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data de devolução deve ser futura&quot;</span><span class="p">)</span>
        
        <span class="n">emprestimo</span> <span class="o">=</span> <span class="n">Emprestimo</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_gerar_id_emprestimo</span><span class="p">(),</span>
            <span class="n">livro_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_id</span><span class="p">,</span>
            <span class="n">usuario_id</span><span class="o">=</span><span class="n">usuario</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">data_emprestimo</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
            <span class="n">data_devolucao</span><span class="o">=</span><span class="n">data_devolucao</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_emprestimos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">emprestimo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_disponivel</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="k">return</span> <span class="n">emprestimo</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">receber_devolucao</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;OPERAÇÃO DE DOMÍNIO: Processa devolução do livro&quot;&quot;&quot;</span>
        <span class="n">emprestimo_ativo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_emprestimo_ativo</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">emprestimo_ativo</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Não há empréstimo ativo para devolver&quot;</span><span class="p">)</span>
        
        <span class="n">emprestimo_ativo</span><span class="o">.</span><span class="n">marcar_como_devolvido</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_disponivel</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># AGGREGATE ROOT: Biblioteca como agregado</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Biblioteca</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    AGGREGATE ROOT: Mantém consistência entre livros e empréstimos.</span>
<span class="sd">    Ponto de entrada para operações que afetam múltiplas entidades.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nome</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_id</span> <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nome</span> <span class="o">=</span> <span class="n">nome</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_livros</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Livro</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_usuarios</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Usuario</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">cadastrar_livro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">titulo</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">autor</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">isbn</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Livro</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        OPERAÇÃO DE AGGREGATE: Garante unicidade de ISBN no contexto da biblioteca.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">isbn_obj</span> <span class="o">=</span> <span class="n">ISBN</span><span class="p">(</span><span class="n">isbn</span><span class="p">)</span>  <span class="c1"># Value object valida formato</span>
        
        <span class="c1"># Regra de negócio: ISBN único por biblioteca</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">livro</span><span class="o">.</span><span class="n">_isbn</span> <span class="o">==</span> <span class="n">isbn_obj</span> <span class="k">for</span> <span class="n">livro</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_livros</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ISBN já cadastrado nesta biblioteca&quot;</span><span class="p">)</span>
        
        <span class="n">livro</span> <span class="o">=</span> <span class="n">Livro</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_gerar_id_livro</span><span class="p">(),</span>
            <span class="n">titulo</span><span class="o">=</span><span class="n">titulo</span><span class="p">,</span>
            <span class="n">autor</span><span class="o">=</span><span class="n">autor</span><span class="p">,</span>
            <span class="n">isbn</span><span class="o">=</span><span class="n">isbn_obj</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_livros</span><span class="p">[</span><span class="n">livro</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">livro</span>
        <span class="k">return</span> <span class="n">livro</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">realizar_emprestimo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livro_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">usuario_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                          <span class="n">data_devolucao</span><span class="p">:</span> <span class="n">datetime</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Emprestimo</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        OPERAÇÃO DE AGGREGATE: Coordena empréstimo entre livro e usuário.</span>
<span class="sd">        Mantém consistência transacional.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">livro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_livros</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">livro_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">livro</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Livro não encontrado&quot;</span><span class="p">)</span>
        
        <span class="n">usuario</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_usuarios</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">usuario_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">usuario</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Usuário não encontrado&quot;</span><span class="p">)</span>
        
        <span class="c1"># Verifica regras que envolvem múltiplas entidades</span>
        <span class="k">if</span> <span class="n">usuario</span><span class="o">.</span><span class="n">tem_multas_pendentes</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Usuário possui multas pendentes&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">usuario</span><span class="o">.</span><span class="n">numero_emprestimos_ativos</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">usuario</span><span class="o">.</span><span class="n">limite_emprestimos</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Usuário atingiu limite de empréstimos&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">livro</span><span class="o">.</span><span class="n">emprestar_para</span><span class="p">(</span><span class="n">usuario</span><span class="p">,</span> <span class="n">data_devolucao</span><span class="p">)</span>

<span class="c1"># DOMAIN SERVICE: Operação que não pertence a uma entidade específica</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CalculadoraPoliticaMulta</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DOMAIN SERVICE: Lógica complexa que envolve múltiplas entidades</span>
<span class="sd">    mas não pertence naturalmente a nenhuma delas.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">calcular_multa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emprestimo</span><span class="p">:</span> <span class="n">Emprestimo</span><span class="p">,</span> <span class="n">usuario</span><span class="p">:</span> <span class="n">Usuario</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Decimal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        LÓGICA DE DOMÍNIO: Calcula multa considerando tipo de usuário,</span>
<span class="sd">        histórico e políticas da biblioteca.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">emprestimo</span><span class="o">.</span><span class="n">esta_atrasado</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.00&#39;</span><span class="p">)</span>
        
        <span class="n">dias_atraso</span> <span class="o">=</span> <span class="n">emprestimo</span><span class="o">.</span><span class="n">dias_de_atraso</span><span class="p">()</span>
        <span class="n">valor_base</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2.00&#39;</span><span class="p">)</span>  <span class="c1"># R$ 2,00 por dia</span>
        
        <span class="c1"># Regra: Estudantes têm 50% de desconto</span>
        <span class="k">if</span> <span class="n">usuario</span><span class="o">.</span><span class="n">tipo</span> <span class="o">==</span> <span class="n">TipoUsuario</span><span class="o">.</span><span class="n">ESTUDANTE</span><span class="p">:</span>
            <span class="n">valor_base</span> <span class="o">*=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.5&#39;</span><span class="p">)</span>
        
        <span class="c1"># Regra: Usuários com bom histórico têm desconto progressivo</span>
        <span class="k">if</span> <span class="n">usuario</span><span class="o">.</span><span class="n">score_credito</span> <span class="o">&gt;</span> <span class="mf">8.0</span><span class="p">:</span>
            <span class="n">valor_base</span> <span class="o">*=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.8&#39;</span><span class="p">)</span>
        
        <span class="c1"># Regra: Multa máxima = valor do livro</span>
        <span class="n">multa_calculada</span> <span class="o">=</span> <span class="n">valor_base</span> <span class="o">*</span> <span class="n">dias_atraso</span>
        <span class="n">multa_maxima</span> <span class="o">=</span> <span class="n">emprestimo</span><span class="o">.</span><span class="n">livro</span><span class="o">.</span><span class="n">valor_estimado</span>
        
        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">multa_calculada</span><span class="p">,</span> <span class="n">multa_maxima</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="analise-de-performance-e-otimizacao">
<h3>4.3. Análise de Performance e Otimização<a class="headerlink" href="#analise-de-performance-e-otimizacao" title="Link to this heading">#</a></h3>
<section id="metricas-de-performance-em-poo">
<h4><strong>Métricas de Performance em POO</strong><a class="headerlink" href="#metricas-de-performance-em-poo" title="Link to this heading">#</a></h4>
<p><strong>Overhead de Abstrações:</strong> Cada nível de abstração introduz custo computacional. É importante medir e otimizar quando necessário.</p>
<p><strong>Principais Gargalos:</strong></p>
<ol class="arabic simple">
<li><p><strong>Chamadas de Método Virtual:</strong> Indireção pode ser custosa em loops intensivos</p></li>
<li><p><strong>Criação Excessiva de Objetos:</strong> Garbage collection pode impactar performance</p></li>
<li><p><strong>Encapsulamento Desnecessário:</strong> Getters/setters simples podem ser substituídos por propriedades</p></li>
<li><p><strong>Padrões Complexos:</strong> Observer com muitos listeners pode gerar overhead</p></li>
</ol>
<p><strong>Técnicas de Otimização:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ANTES: Ineficiente para grandes volumes</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ProcessadorIneficiente</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">processar_livros</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livros</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Livro</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">RelatorioLivro</span><span class="p">]:</span>
        <span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">livro</span> <span class="ow">in</span> <span class="n">livros</span><span class="p">:</span>
            <span class="c1"># Criação desnecessária de objetos</span>
            <span class="n">relatorio</span> <span class="o">=</span> <span class="n">RelatorioLivro</span><span class="p">()</span>
            <span class="n">relatorio</span><span class="o">.</span><span class="n">set_titulo</span><span class="p">(</span><span class="n">livro</span><span class="o">.</span><span class="n">get_titulo</span><span class="p">())</span>
            <span class="n">relatorio</span><span class="o">.</span><span class="n">set_autor</span><span class="p">(</span><span class="n">livro</span><span class="o">.</span><span class="n">get_autor</span><span class="p">())</span>
            <span class="n">relatorio</span><span class="o">.</span><span class="n">set_disponibilidade</span><span class="p">(</span><span class="n">livro</span><span class="o">.</span><span class="n">is_disponivel</span><span class="p">())</span>
            <span class="n">resultados</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">relatorio</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resultados</span>

<span class="c1"># DEPOIS: Otimizado para performance</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ProcessadorOtimizado</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Pool de objetos reutilizáveis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pool_relatorios</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">RelatorioLivro</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">processar_livros</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livros</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Livro</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">RelatorioLivro</span><span class="p">]:</span>
        <span class="c1"># List comprehension é mais eficiente</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_criar_relatorio_eficiente</span><span class="p">(</span><span class="n">livro</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">livro</span> <span class="ow">in</span> <span class="n">livros</span>
        <span class="p">]</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_criar_relatorio_eficiente</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livro</span><span class="p">:</span> <span class="n">Livro</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RelatorioLivro</span><span class="p">:</span>
        <span class="c1"># Reutiliza objeto do pool se disponível</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool_relatorios</span><span class="p">:</span>
            <span class="n">relatorio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool_relatorios</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="n">relatorio</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">relatorio</span> <span class="o">=</span> <span class="n">RelatorioLivro</span><span class="p">()</span>
        
        <span class="c1"># Acesso direto a atributos quando seguro</span>
        <span class="n">relatorio</span><span class="o">.</span><span class="n">titulo</span> <span class="o">=</span> <span class="n">livro</span><span class="o">.</span><span class="n">titulo</span>
        <span class="n">relatorio</span><span class="o">.</span><span class="n">autor</span> <span class="o">=</span> <span class="n">livro</span><span class="o">.</span><span class="n">autor</span>
        <span class="n">relatorio</span><span class="o">.</span><span class="n">disponivel</span> <span class="o">=</span> <span class="n">livro</span><span class="o">.</span><span class="n">disponivel</span>
        
        <span class="k">return</span> <span class="n">relatorio</span>

<span class="c1"># BENCHMARK: Comparação de performance</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span>

<span class="k">def</span><span class="w"> </span><span class="nf">benchmark_processamento</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">livros</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Livro</span><span class="p">],</span> 
                          <span class="n">num_execucoes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mede tempo de execução médio de função de processamento&quot;&quot;&quot;</span>
    <span class="n">tempos</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_execucoes</span><span class="p">):</span>
        <span class="n">inicio</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">resultado</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">livros</span><span class="p">)</span>
        <span class="n">fim</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">tempos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fim</span> <span class="o">-</span> <span class="n">inicio</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">tempos</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">tempos</span><span class="p">)</span>

<span class="c1"># Uso do benchmark</span>
<span class="k">def</span><span class="w"> </span><span class="nf">comparar_implementacoes</span><span class="p">():</span>
    <span class="n">livros</span> <span class="o">=</span> <span class="p">[</span><span class="n">Livro</span><span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>  <span class="c1"># 1000 livros de teste</span>
    
    <span class="n">ineficiente</span> <span class="o">=</span> <span class="n">ProcessadorIneficiente</span><span class="p">()</span>
    <span class="n">otimizado</span> <span class="o">=</span> <span class="n">ProcessadorOtimizado</span><span class="p">()</span>
    
    <span class="n">tempo_ineficiente</span> <span class="o">=</span> <span class="n">benchmark_processamento</span><span class="p">(</span>
        <span class="n">ineficiente</span><span class="o">.</span><span class="n">processar_livros</span><span class="p">,</span> <span class="n">livros</span>
    <span class="p">)</span>
    <span class="n">tempo_otimizado</span> <span class="o">=</span> <span class="n">benchmark_processamento</span><span class="p">(</span>
        <span class="n">otimizado</span><span class="o">.</span><span class="n">processar_livros</span><span class="p">,</span> <span class="n">livros</span>
    <span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Implementação ineficiente: </span><span class="si">{</span><span class="n">tempo_ineficiente</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Implementação otimizada: </span><span class="si">{</span><span class="n">tempo_otimizado</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Speedup: </span><span class="si">{</span><span class="n">tempo_ineficiente</span><span class="o">/</span><span class="n">tempo_otimizado</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="profiling-e-identificacao-de-gargalos">
<h4><strong>Profiling e Identificação de Gargalos</strong><a class="headerlink" href="#profiling-e-identificacao-de-gargalos" title="Link to this heading">#</a></h4>
<p><strong>Ferramentas de Profile:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cProfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pstats</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">wraps</span>

<span class="k">def</span><span class="w"> </span><span class="nf">profile_method</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator para profile automático de métodos&quot;&quot;&quot;</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">profiler</span> <span class="o">=</span> <span class="n">cProfile</span><span class="o">.</span><span class="n">Profile</span><span class="p">()</span>
        <span class="n">profiler</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
        
        <span class="n">resultado</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="n">profiler</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="n">pstats</span><span class="o">.</span><span class="n">Stats</span><span class="p">(</span><span class="n">profiler</span><span class="p">)</span>
        <span class="n">stats</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="s1">&#39;cumulative&#39;</span><span class="p">)</span>
        <span class="n">stats</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Top 10 funções mais custosas</span>
        
        <span class="k">return</span> <span class="n">resultado</span>
    <span class="k">return</span> <span class="n">wrapper</span>

<span class="c1"># Uso em métodos críticos</span>
<span class="k">class</span><span class="w"> </span><span class="nc">GerenciadorBiblioteca</span><span class="p">:</span>
    <span class="nd">@profile_method</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">processar_relatorio_mensal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mes</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ano</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RelatorioMensal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Método que pode ser custoso - profile automático&quot;&quot;&quot;</span>
        <span class="c1"># ... implementação complexa</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ServicoGestaoLivros</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">repo</span><span class="p">:</span> <span class="n">RepositorioLivrosPort</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_repo</span> <span class="o">=</span> <span class="n">repo</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">cadastrar_livro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dados</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Livro</span><span class="p">:</span>
        <span class="c1"># Validações de negócio</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">dados</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;titulo&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Título é obrigatório&quot;</span><span class="p">)</span>
        
        <span class="n">livro</span> <span class="o">=</span> <span class="n">Livro</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># Será definido pelo repositório</span>
            <span class="n">titulo</span><span class="o">=</span><span class="n">dados</span><span class="p">[</span><span class="s1">&#39;titulo&#39;</span><span class="p">],</span>
            <span class="n">autor</span><span class="o">=</span><span class="n">dados</span><span class="p">[</span><span class="s1">&#39;autor&#39;</span><span class="p">],</span>
            <span class="n">isbn</span><span class="o">=</span><span class="n">dados</span><span class="p">[</span><span class="s1">&#39;isbn&#39;</span><span class="p">]</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_repo</span><span class="o">.</span><span class="n">salvar</span><span class="p">(</span><span class="n">livro</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">livro</span>

<span class="c1"># ADAPTADOR: Implementação específica para PostgreSQL</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RepositorioLivrosPostgreSQL</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connection_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">connection_string</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">salvar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livro</span><span class="p">:</span> <span class="n">Livro</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Implementação específica do PostgreSQL</span>
        <span class="k">pass</span>

<span class="c1"># ADAPTADOR: Implementação para testes (in-memory)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RepositorioLivrosMemoria</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_livros</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Livro</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_id</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">salvar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">livro</span><span class="p">:</span> <span class="n">Livro</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">livro</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_livros</span><span class="p">[</span><span class="n">livro</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">livro</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_id</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="event-sourcing-com-poo">
<h4><strong>Event Sourcing com POO</strong><a class="headerlink" href="#event-sourcing-com-poo" title="Link to this heading">#</a></h4>
<p><strong>Conceito:</strong> Em vez de armazenar estado atual, armazena sequência de eventos que levaram ao estado.</p>
<p><strong>Vantagens:</strong></p>
<ul class="simple">
<li><p>Auditoria completa de mudanças</p></li>
<li><p>Possibilidade de “replay” de eventos</p></li>
<li><p>Debugging facilitado</p></li>
</ul>
<p><strong>Comparação com CRUD tradicional:</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Aspecto</p></th>
<th class="head"><p>CRUD Tradicional</p></th>
<th class="head"><p>Event Sourcing</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Armazenamento</strong></p></td>
<td><p>Estado atual</p></td>
<td><p>Sequência de eventos</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Auditoria</strong></p></td>
<td><p>Logs separados</p></td>
<td><p>Inerente ao modelo</p></td>
</tr>
<tr class="row-even"><td><p><strong>Debugging</strong></p></td>
<td><p>Difícil</p></td>
<td><p>Replay de eventos</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Complexidade</strong></p></td>
<td><p>Baixa</p></td>
<td><p>Alta</p></td>
</tr>
<tr class="row-even"><td><p><strong>Performance de Leitura</strong></p></td>
<td><p>Alta</p></td>
<td><p>Requer reconstrução</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="id1">
<h3>4.3. Análise de Performance e Otimização<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<section id="metricas-de-qualidade-de-codigo">
<h4><strong>Métricas de Qualidade de Código</strong><a class="headerlink" href="#metricas-de-qualidade-de-codigo" title="Link to this heading">#</a></h4>
<p><strong>Complexidade Ciclomática:</strong>
$<span class="math notranslate nohighlight">\(V(G) = E - N + 2P\)</span>$</p>
<p>Onde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E\)</span> = número de arestas no grafo de fluxo</p></li>
<li><p><span class="math notranslate nohighlight">\(N\)</span> = número de nós</p></li>
<li><p><span class="math notranslate nohighlight">\(P\)</span> = número de componentes conectados</p></li>
</ul>
<p><strong>Interpretação:</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(V(G) \leq 10\)</span>: Baixa complexidade, fácil de testar</p></li>
<li><p><span class="math notranslate nohighlight">\(10 &lt; V(G) \leq 20\)</span>: Complexidade moderada</p></li>
<li><p><span class="math notranslate nohighlight">\(V(G) &gt; 20\)</span>: Alta complexidade, refatoração recomendada</p></li>
</ul>
<p><strong>Exemplo de Análise:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">processar_emprestimo</span><span class="p">(</span><span class="n">livro_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">usuario_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="c1"># Complexidade = 4 (4 caminhos independentes)</span>
    <span class="n">livro</span> <span class="o">=</span> <span class="n">buscar_livro</span><span class="p">(</span><span class="n">livro_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">livro</span><span class="p">:</span>           <span class="c1"># +1</span>
        <span class="k">return</span> <span class="kc">False</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">livro</span><span class="o">.</span><span class="n">disponivel</span><span class="p">:</span> <span class="c1"># +1</span>
        <span class="k">return</span> <span class="kc">False</span>
    
    <span class="n">usuario</span> <span class="o">=</span> <span class="n">buscar_usuario</span><span class="p">(</span><span class="n">usuario_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">usuario</span><span class="p">:</span>         <span class="c1"># +1</span>
        <span class="k">return</span> <span class="kc">False</span>
    
    <span class="k">if</span> <span class="n">usuario</span><span class="o">.</span><span class="n">bloqueado</span><span class="p">:</span>   <span class="c1"># +1</span>
        <span class="k">return</span> <span class="kc">False</span>
    
    <span class="c1"># Realizar empréstimo</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
<p><strong>Métricas de Acoplamento:</strong></p>
<ul class="simple">
<li><p><strong>Acoplamento Aferente (Ca):</strong> Quantas classes dependem desta classe</p></li>
<li><p><strong>Acoplamento Eferente (Ce):</strong> De quantas classes esta classe depende</p></li>
<li><p><strong>Instabilidade:</strong> <span class="math notranslate nohighlight">\(I = \frac{Ce}{Ca + Ce}\)</span> (0 = estável, 1 = instável)</p></li>
</ul>
<p><strong>Ferramentas de Medição:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Usando pytest-benchmark para medir performance</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_benchmark_busca_livros</span><span class="p">(</span><span class="n">benchmark</span><span class="p">):</span>
    <span class="n">livros</span> <span class="o">=</span> <span class="n">criar_lista_livros</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">buscador</span> <span class="o">=</span> <span class="n">BuscadorLivros</span><span class="p">(</span><span class="n">BuscaPorTitulo</span><span class="p">())</span>
    
    <span class="n">resultado</span> <span class="o">=</span> <span class="n">benchmark</span><span class="p">(</span><span class="n">buscador</span><span class="o">.</span><span class="n">buscar</span><span class="p">,</span> <span class="n">livros</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultado</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

<span class="c1"># Usando radon para medir complexidade</span>
<span class="c1"># $ pip install radon</span>
<span class="c1"># $ radon cc -s meu_modulo.py</span>
<span class="c1"># A 1:0 MinhaClasse - A (2)</span>
<span class="c1"># B 15:4 meu_metodo - B (6)</span>
</pre></div>
</div>
<p><strong>Otimização de Padrões:</strong></p>
<ol class="arabic simple">
<li><p><strong>Strategy Pattern - Lazy Loading:</strong></p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">BuscadorComCache</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_estrategias</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">buscar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">estrategia_nome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">livros</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Livro</span><span class="p">],</span> <span class="n">termo</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Lazy loading da estratégia</span>
        <span class="k">if</span> <span class="n">estrategia_nome</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estrategias</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_estrategias</span><span class="p">[</span><span class="n">estrategia_nome</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_criar_estrategia</span><span class="p">(</span><span class="n">estrategia_nome</span><span class="p">)</span>
        
        <span class="c1"># Cache de resultados</span>
        <span class="n">cache_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">estrategia_nome</span><span class="p">,</span> <span class="n">termo</span><span class="p">,</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">livros</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">cache_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">:</span>
            <span class="n">estrategia</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estrategias</span><span class="p">[</span><span class="n">estrategia_nome</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">estrategia</span><span class="o">.</span><span class="n">buscar</span><span class="p">(</span><span class="n">livros</span><span class="p">,</span> <span class="n">termo</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p><strong>Observer Pattern - Async:</strong></p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Awaitable</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ObservadorAsync</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">notificar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evento</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dados</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PublicadorAsync</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_observadores</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ObservadorAsync</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">notificar_todos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evento</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dados</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Notifica todos observadores em paralelo.&quot;&quot;&quot;</span>
        <span class="n">tarefas</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">obs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observadores</span><span class="p">:</span>
            <span class="n">tarefa</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">notificar</span><span class="p">(</span><span class="n">evento</span><span class="p">,</span> <span class="n">dados</span><span class="p">)</span>
            <span class="n">tarefas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarefa</span><span class="p">)</span>
        
        <span class="c1"># Executa todas as notificações em paralelo</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tarefas</span><span class="p">,</span> <span class="n">return_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="sintese-e-perspectivas-futuras">
<h2>5. Síntese e Perspectivas Futuras<a class="headerlink" href="#sintese-e-perspectivas-futuras" title="Link to this heading">#</a></h2>
<section id="conexoes-com-outras-areas-da-computacao">
<h3>5.1. Conexões com Outras Áreas da Computação<a class="headerlink" href="#conexoes-com-outras-areas-da-computacao" title="Link to this heading">#</a></h3>
<section id="engenharia-de-software">
<h4><strong>Engenharia de Software</strong><a class="headerlink" href="#engenharia-de-software" title="Link to this heading">#</a></h4>
<p>Os padrões de design são fundamentais para arquiteturas de sistemas robustos e escaláveis:</p>
<ul class="simple">
<li><p><strong>Microserviços:</strong> Padrões como Factory e Strategy facilitam a criação de serviços independentes e intercambiáveis</p></li>
<li><p><strong>DevOps:</strong> Princípios SOLID melhoram a testabilidade, facilitando CI/CD e deployment contínuo</p></li>
<li><p><strong>Arquitetura de Software:</strong> Padrões arquiteturais (MVC, MVP, MVVM) são extensões dos padrões de design estudados</p></li>
</ul>
<p><strong>Exemplo de Conexão:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Microserviço usando Factory Pattern</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FabricaServico</span><span class="p">:</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">criar_servico</span><span class="p">(</span><span class="n">tipo</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServicoBase</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s2">&quot;emprestimo&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ServicoEmprestimo</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s2">&quot;multa&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ServicoMulta</span><span class="p">()</span>
        <span class="c1"># Facilita adicionar novos microserviços</span>
</pre></div>
</div>
</section>
<section id="ciencia-de-dados-e-ia">
<h4><strong>Ciência de Dados e IA</strong><a class="headerlink" href="#ciencia-de-dados-e-ia" title="Link to this heading">#</a></h4>
<p>Princípios de modularidade e desacoplamento são essenciais para pipelines de dados e modelos de ML:</p>
<ul class="simple">
<li><p><strong>Pipeline de Dados:</strong> Strategy pattern para diferentes algoritmos de processamento</p></li>
<li><p><strong>Model Training:</strong> Observer pattern para monitoramento de métricas durante treinamento</p></li>
<li><p><strong>Feature Engineering:</strong> Factory pattern para criação de diferentes transformadores</p></li>
</ul>
<p><strong>Exemplo de Aplicação:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pipeline de ML com Strategy Pattern</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PreprocessadorStrategy</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">processar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dados</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span> <span class="o">...</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PreprocessadorTexto</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">processar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dados</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
        <span class="c1"># Tokenização, remoção de stopwords, etc.</span>
        <span class="k">return</span> <span class="n">dados</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PreprocessadorNumerico</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">processar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dados</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
        <span class="c1"># Normalização, tratamento de outliers, etc.</span>
        <span class="k">return</span> <span class="n">dados</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PipelineML</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">preprocessador</span><span class="p">:</span> <span class="n">PreprocessadorStrategy</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocessador</span> <span class="o">=</span> <span class="n">preprocessador</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">treinar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dados</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
        <span class="n">dados_processados</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocessador</span><span class="o">.</span><span class="n">processar</span><span class="p">(</span><span class="n">dados</span><span class="p">)</span>
        <span class="c1"># Treinar modelo...</span>
</pre></div>
</div>
</section>
<section id="sistemas-distribuidos">
<h4><strong>Sistemas Distribuídos</strong><a class="headerlink" href="#sistemas-distribuidos" title="Link to this heading">#</a></h4>
<p>Padrões de design são amplamente aplicados em sistemas distribuídos:</p>
<ul class="simple">
<li><p><strong>Observer Pattern:</strong> Implementado como pub/sub em sistemas de mensageria (Kafka, RabbitMQ)</p></li>
<li><p><strong>Factory Pattern:</strong> Para criação de diferentes tipos de clientes de API</p></li>
<li><p><strong>Strategy Pattern:</strong> Para diferentes algoritmos de balanceamento de carga</p></li>
</ul>
</section>
<section id="seguranca-da-informacao">
<h4><strong>Segurança da Informação</strong><a class="headerlink" href="#seguranca-da-informacao" title="Link to this heading">#</a></h4>
<p>Boas práticas de POO contribuem para segurança:</p>
<ul class="simple">
<li><p><strong>Encapsulamento:</strong> Previne acesso indevido a dados sensíveis</p></li>
<li><p><strong>Princípio da Responsabilidade Única:</strong> Facilita auditoria de segurança</p></li>
<li><p><strong>Dependency Inversion:</strong> Permite injeção segura de dependências validadas</p></li>
</ul>
</section>
</section>
<section id="a-fronteira-da-pesquisa-e-o-futuro">
<h3>5.2. A Fronteira da Pesquisa e o Futuro<a class="headerlink" href="#a-fronteira-da-pesquisa-e-o-futuro" title="Link to this heading">#</a></h3>
<section id="tendencias-atuais-2025">
<h4><strong>Tendências Atuais (2025)</strong><a class="headerlink" href="#tendencias-atuais-2025" title="Link to this heading">#</a></h4>
<p><strong>1. Padrões para Sistemas Assíncronos:</strong></p>
<ul class="simple">
<li><p>Async/await patterns em Python estão evoluindo</p></li>
<li><p>Padrões reativos para streaming de dados</p></li>
<li><p>Observer pattern distribuído com event streaming</p></li>
</ul>
<p><strong>2. IA-Assisted Refactoring:</strong></p>
<ul class="simple">
<li><p>Ferramentas como GitHub Copilot e ChatGPT auxiliam na aplicação de padrões</p></li>
<li><p>Refatoração automática baseada em análise de código</p></li>
<li><p>Sugestões inteligentes de padrões baseadas no contexto</p></li>
</ul>
<p><strong>3. Type Safety e Pattern Matching:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Python 3.12+ com pattern matching avançado</span>
<span class="k">def</span><span class="w"> </span><span class="nf">processar_evento</span><span class="p">(</span><span class="n">evento</span><span class="p">):</span>
    <span class="k">match</span> <span class="n">evento</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">EmprestimoRealizado</span><span class="p">(</span><span class="n">livro_id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">usuario_id</span><span class="o">=</span><span class="n">uid</span><span class="p">):</span>
            <span class="n">notificar_emprestimo</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">uid</span><span class="p">)</span>
        <span class="k">case</span> <span class="n">DevolucaoRealizada</span><span class="p">(</span><span class="n">emprestimo_id</span><span class="o">=</span><span class="n">eid</span><span class="p">):</span>
            <span class="n">processar_devolucao</span><span class="p">(</span><span class="n">eid</span><span class="p">)</span>
        <span class="k">case</span> <span class="n">MultaAplicada</span><span class="p">(</span><span class="n">valor</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">emprestimo_id</span><span class="o">=</span><span class="n">eid</span><span class="p">):</span>
            <span class="n">registrar_multa</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">eid</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>4. Sustainable Software Development:</strong></p>
<ul class="simple">
<li><p>Padrões que otimizam consumo energético</p></li>
<li><p>Design para eficiência computacional</p></li>
<li><p>Green software patterns</p></li>
</ul>
</section>
<section id="pesquisas-emergentes">
<h4><strong>Pesquisas Emergentes</strong><a class="headerlink" href="#pesquisas-emergentes" title="Link to this heading">#</a></h4>
<p><strong>1. Quantum Computing Patterns:</strong></p>
<ul class="simple">
<li><p>Adaptação de padrões clássicos para computação quântica</p></li>
<li><p>Novos padrões específicos para algoritmos quânticos</p></li>
</ul>
<p><strong>2. Edge Computing Patterns:</strong></p>
<ul class="simple">
<li><p>Padrões para dispositivos com recursos limitados</p></li>
<li><p>Sincronização entre edge e cloud</p></li>
</ul>
<p><strong>3. Blockchain e Distributed Ledger:</strong></p>
<ul class="simple">
<li><p>Padrões para smart contracts</p></li>
<li><p>Design patterns para aplicações descentralizadas (DApps)</p></li>
</ul>
</section>
</section>
<section id="resumo-do-capitulo-e-mapa-mental">
<h3>5.3. Resumo do Capítulo e Mapa Mental<a class="headerlink" href="#resumo-do-capitulo-e-mapa-mental" title="Link to this heading">#</a></h3>
<section id="pontos-chave-do-capitulo">
<h4><strong>Pontos-Chave do Capítulo:</strong><a class="headerlink" href="#pontos-chave-do-capitulo" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p><strong>Princípios SOLID</strong> são a base para código limpo e manutenível</p></li>
<li><p><strong>Coesão alta e acoplamento baixo</strong> são métricas fundamentais de qualidade</p></li>
<li><p><strong>Padrões de Design</strong> oferecem soluções comprovadas para problemas recorrentes</p></li>
<li><p><strong>Refatoração contínua</strong> é essencial para manter qualidade ao longo do tempo</p></li>
<li><p><strong>Ferramentas modernas</strong> (ruff, mypy, pytest) automatizam verificação de qualidade</p></li>
<li><p><strong>Anti-padrões</strong> devem ser identificados e evitados proativamente</p></li>
<li><p><strong>Performance</strong> deve ser medida antes de otimizar (profile first, optimize later)</p></li>
</ol>
</section>
<section id="mapa-mental-dos-conceitos">
<h4><strong>Mapa Mental dos Conceitos:</strong><a class="headerlink" href="#mapa-mental-dos-conceitos" title="Link to this heading">#</a></h4>
<div class="highlight-mermaid notranslate"><div class="highlight"><pre><span></span>mindmap
  root((Boas Práticas POO))
    Princípios SOLID
      SRP
        Uma responsabilidade
        Uma razão para mudar
      OCP
        Aberto para extensão
        Fechado para modificação
      LSP
        Substituição transparente
        Contratos comportamentais
      ISP
        Interfaces específicas
        Não forçar dependências
      DIP
        Abstrações estáveis
        Detalhes dependem de abstrações
    
    Padrões de Design
      Criacionais
        Factory Method
        Abstract Factory
      Comportamentais
        Strategy
        Observer
        Command
      Estruturais
        Adapter
        Decorator
        Facade
    
    Métricas de Qualidade
      Coesão
        LCOM
        Responsabilidade única
      Acoplamento
        Aferente/Eferente
        Instabilidade
      Complexidade
        Ciclomática
        Cognitiva
    
    Ferramentas Modernas
      Linting
        ruff
        flake8
      Type Checking
        mypy
        pyright
      Testing
        pytest
        coverage
      Automation
        pre-commit
        CI/CD
</pre></div>
</div>
</section>
</section>
<section id="referencias-e-leituras-adicionais">
<h3>5.4. Referências e Leituras Adicionais<a class="headerlink" href="#referencias-e-leituras-adicionais" title="Link to this heading">#</a></h3>
<section id="livros-fundamentais">
<h4><strong>Livros Fundamentais:</strong><a class="headerlink" href="#livros-fundamentais" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Gamma, E., Helm, R., Johnson, R., &amp; Vlissides, J. (1994). <em>Design Patterns: Elements of Reusable Object-Oriented Software</em>. Addison-Wesley.</p></li>
<li><p>Fowler, M. (2018). <em>Refactoring: Improving the Design of Existing Code</em> (2ª ed.). Addison-Wesley.</p></li>
<li><p>Martin, R. C. (2017). <em>Clean Architecture: A Craftsman’s Guide to Software Structure and Design</em>. Prentice Hall.</p></li>
<li><p>Martin, R. C. (2008). <em>Clean Code: A Handbook of Agile Software Craftsmanship</em>. Prentice Hall.</p></li>
</ul>
</section>
<section id="recursos-online">
<h4><strong>Recursos Online:</strong><a class="headerlink" href="#recursos-online" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Python Enhancement Proposals (PEPs):</strong></p>
<ul>
<li><p>PEP 8 – Style Guide for Python Code: <a class="reference external" href="https://peps.python.org/pep-0008/">https://peps.python.org/pep-0008/</a></p></li>
<li><p>PEP 20 – The Zen of Python: <a class="reference external" href="https://peps.python.org/pep-0020/">https://peps.python.org/pep-0020/</a></p></li>
<li><p>PEP 484 – Type Hints: <a class="reference external" href="https://peps.python.org/pep-0484/">https://peps.python.org/pep-0484/</a></p></li>
</ul>
</li>
<li><p><strong>Documentação Oficial:</strong></p>
<ul>
<li><p>Python Documentation: <a class="reference external" href="https://docs.python.org/3/">https://docs.python.org/3/</a></p></li>
<li><p>pytest Documentation: <a class="reference external" href="https://docs.pytest.org/">https://docs.pytest.org/</a></p></li>
<li><p>mypy Documentation: <a class="reference external" href="https://mypy.readthedocs.io/">https://mypy.readthedocs.io/</a></p></li>
</ul>
</li>
</ul>
</section>
<section id="artigos-e-papers-relevantes">
<h4><strong>Artigos e Papers Relevantes:</strong><a class="headerlink" href="#artigos-e-papers-relevantes" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Beck, K. (2000). “Extreme Programming Explained: Embrace Change”. Addison-Wesley.</p></li>
<li><p>Evans, E. (2003). “Domain-Driven Design: Tackling Complexity in the Heart of Software”. Addison-Wesley.</p></li>
<li><p>Kerievsky, J. (2004). “Refactoring to Patterns”. Addison-Wesley.</p></li>
</ul>
</section>
<section id="ferramentas-e-ecossistema">
<h4><strong>Ferramentas e Ecossistema:</strong><a class="headerlink" href="#ferramentas-e-ecossistema" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Ruff:</strong> <a class="github reference external" href="https://github.com/astral-sh/ruff">astral-sh/ruff</a></p></li>
<li><p><strong>uv:</strong> <a class="github reference external" href="https://github.com/astral-sh/uv">astral-sh/uv</a></p></li>
<li><p><strong>pre-commit:</strong> <a class="reference external" href="https://pre-commit.com/">https://pre-commit.com/</a></p></li>
<li><p><strong>testcontainers-python:</strong> <a class="github reference external" href="https://github.com/testcontainers/testcontainers-python">testcontainers/testcontainers-python</a></p></li>
</ul>
</section>
<section id="comunidades-e-recursos-continuos">
<h4><strong>Comunidades e Recursos Contínuos:</strong><a class="headerlink" href="#comunidades-e-recursos-continuos" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Python Brasil:</strong> <a class="reference external" href="https://python.org.br/">https://python.org.br/</a></p></li>
<li><p><strong>Real Python:</strong> <a class="reference external" href="https://realpython.com/">https://realpython.com/</a></p></li>
<li><p><strong>Python Weekly:</strong> <a class="reference external" href="https://www.pythonweekly.com/">https://www.pythonweekly.com/</a></p></li>
<li><p><strong>Talk Python Podcast:</strong> <a class="reference external" href="https://talkpython.fm/">https://talkpython.fm/</a></p></li>
</ul>
<hr class="docutils" />
<p><em>Este capítulo estabelece as fundações sólidas necessárias para o desenvolvimento de software de qualidade. Os conceitos aqui apresentados serão aplicados e aprofundados ao longo de todo o curso, constituindo a base teórica e prática para todas as aulas subsequentes.</em></p>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs/aulas/aula-01-02-boas-praticas-design-patters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../../README.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Programação Orientada a Objetos II (POOII) - Python</p>
      </div>
    </a>
    <a class="right-next"
       href="../aula-03-04-ambiente-profissional-python/README.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Ambiente Profissional de Projetos Python</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sumario">Sumário</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#abertura-e-engajamento">1. Abertura e Engajamento</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problema-motivador">1.1. Problema Motivador</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#contexto-historico-e-relevancia-atual">1.2. Contexto Histórico e Relevância Atual</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fundamentos-teoricos">2. Fundamentos Teóricos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#terminologia-essencial-e-definicoes-formais"><strong>2.1. Terminologia Essencial e Definições Formais</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-limpo"><strong>Código Limpo</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#coesao"><strong>Coesão</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#acoplamento"><strong>Acoplamento</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estrutura-conceitual"><strong>2.2. Estrutura Conceitual</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#principios-de-boas-praticas-base-cientifica-do-design"><strong>2.2.1. Princípios de Boas Práticas - Base Científica do Design</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#single-responsibility-principle-srp"><strong>Single Responsibility Principle (SRP)</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#open-closed-principle-ocp"><strong>Open/Closed Principle (OCP)</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#liskov-substitution-principle-lsp"><strong>Liskov Substitution Principle (LSP)</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#interface-segregation-principle-isp"><strong>Interface Segregation Principle (ISP)</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dependency-inversion-principle-dip"><strong>Dependency Inversion Principle (DIP)</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dry-don-t-repeat-yourself"><strong>DRY (Don’t Repeat Yourself)</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#yagni-you-aren-t-gonna-need-it"><strong>YAGNI (You Aren’t Gonna Need It)</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#kiss-keep-it-simple-stupid"><strong>KISS (Keep It Simple, Stupid)</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#padroes-de-design-solucoes-catalogadas-para-problemas-recorrentes"><strong>2.2.2. Padrões de Design - Soluções Catalogadas para Problemas Recorrentes</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#strategy-pattern"><strong>Strategy Pattern</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#observer-pattern"><strong>Observer Pattern</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#command-pattern"><strong>Command Pattern</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-method-pattern"><strong>Factory Method Pattern</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#singleton-pattern"><strong>Singleton Pattern</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#adapter-pattern"><strong>Adapter Pattern</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analise-quantitativa-metricas-de-qualidade-de-software"><strong>2.3. Análise Quantitativa - Métricas de Qualidade de Software</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#metrica-de-coesao-lcom-lack-of-cohesion-of-methods"><strong>Métrica de Coesão LCOM (Lack of Cohesion of Methods)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#metrica-de-instabilidade-acoplamento-eferente-vs-aferente"><strong>Métrica de Instabilidade (Acoplamento Eferente vs. Aferente)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#complexidade-ciclomatica-de-mccabe"><strong>Complexidade Ciclomática de McCabe</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analise-critica"><strong>2.4. Análise Crítica</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#limitacoes-e-trade-offs-dos-principios"><strong>Limitações e Trade-offs dos Princípios</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#faq-perguntas-frequentes-e-armadilhas-comuns"><strong>FAQ - Perguntas Frequentes e Armadilhas Comuns</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tabela-comparativa-paradigmas-e-suas-implicacoes"><strong>Tabela Comparativa: Paradigmas e Suas Implicações</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacao-pratica-e-implementacao">3. Aplicação Prática e Implementação</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estudo-de-caso-guiado">3.1. Estudo de Caso Guiado</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#passo-1-analise-do-problema"><strong>Passo 1: Análise do Problema</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#passo-2-implementacao-inicial-problematica"><strong>Passo 2: Implementação Inicial Problemática</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#passo-3-refatoracao-aplicando-srp"><strong>Passo 3: Refatoração Aplicando SRP</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#passo-4-aplicando-open-closed-principle"><strong>Passo 4: Aplicando Open/Closed Principle</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exemplos-de-codigo-comentado">3.2. Exemplos de Código Comentado</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacao-do-padrao-strategy"><strong>Implementação do Padrão Strategy</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacao-do-padrao-factory-method"><strong>Implementação do Padrão Factory Method</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacao-do-padrao-observer"><strong>Implementação do Padrão Observer</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ferramentas-bibliotecas-e-ecossistema-contextual"><strong>3.3. Ferramentas, Bibliotecas e Ecossistema (Contextual)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recursos-nativos-utilizados"><strong>Recursos Nativos Utilizados</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#por-que-apenas-python-nativo"><strong>Por Que Apenas Python Nativo?</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ambiente-de-desenvolvimento-recomendado"><strong>Ambiente de Desenvolvimento Recomendado</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topicos-avancados-e-nuances">4. Tópicos Avançados e Nuances</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#desafios-comuns-e-anti-padroes">4.1. Desafios Comuns e “Anti-Padrões”</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#god-object-objeto-deus"><strong>God Object (Objeto Deus)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spaghetti-code-codigo-espaguete"><strong>Spaghetti Code (Código Espaguete)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shotgun-surgery-cirurgia-com-espingarda"><strong>Shotgun Surgery (Cirurgia com Espingarda)</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variacoes-e-arquiteturas-especializadas">4.2. Variações e Arquiteturas Especializadas</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arquitetura-hexagonal-ports-and-adapters"><strong>Arquitetura Hexagonal (Ports and Adapters)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#domain-driven-design-ddd-com-poo"><strong>Domain-Driven Design (DDD) com POO</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analise-de-performance-e-otimizacao">4.3. Análise de Performance e Otimização</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-performance-em-poo"><strong>Métricas de Performance em POO</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#profiling-e-identificacao-de-gargalos"><strong>Profiling e Identificação de Gargalos</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#event-sourcing-com-poo"><strong>Event Sourcing com POO</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">4.3. Análise de Performance e Otimização</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-qualidade-de-codigo"><strong>Métricas de Qualidade de Código</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sintese-e-perspectivas-futuras">5. Síntese e Perspectivas Futuras</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conexoes-com-outras-areas-da-computacao">5.1. Conexões com Outras Áreas da Computação</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#engenharia-de-software"><strong>Engenharia de Software</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ciencia-de-dados-e-ia"><strong>Ciência de Dados e IA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sistemas-distribuidos"><strong>Sistemas Distribuídos</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#seguranca-da-informacao"><strong>Segurança da Informação</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-fronteira-da-pesquisa-e-o-futuro">5.2. A Fronteira da Pesquisa e o Futuro</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tendencias-atuais-2025"><strong>Tendências Atuais (2025)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pesquisas-emergentes"><strong>Pesquisas Emergentes</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resumo-do-capitulo-e-mapa-mental">5.3. Resumo do Capítulo e Mapa Mental</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pontos-chave-do-capitulo"><strong>Pontos-Chave do Capítulo:</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mapa-mental-dos-conceitos"><strong>Mapa Mental dos Conceitos:</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#referencias-e-leituras-adicionais">5.4. Referências e Leituras Adicionais</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#livros-fundamentais"><strong>Livros Fundamentais:</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recursos-online"><strong>Recursos Online:</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#artigos-e-papers-relevantes"><strong>Artigos e Papers Relevantes:</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ferramentas-e-ecossistema"><strong>Ferramentas e Ecossistema:</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comunidades-e-recursos-continuos"><strong>Comunidades e Recursos Contínuos:</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jackson Antonio do Prado Lima
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>